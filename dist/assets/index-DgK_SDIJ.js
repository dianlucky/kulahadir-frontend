import{e as I,s as B,k as H,d as W,z as K,r as n,j as e,B as c,A as Q,D as f,C as T,T as P,N as v,$ as Y}from"./index-DB885r8G.js";import{u as J,a as X}from"./deleteAccount-X_csYcNV.js";import{p as Te}from"./deleteAccount-X_csYcNV.js";import{u as Z}from"./getAccount-DDAOzpy6.js";import{a as Se,g as De,b as Ie}from"./getAccount-DDAOzpy6.js";import{T as t}from"./Table-8nKp-RGz.js";import{B as _}from"./Badge-CIzkc8PY.js";import{I as S}from"./IconPencil-ohpWopQ4.js";import{I as ee}from"./IconTrash-CJqVm7PQ.js";import{u as D}from"./use-form-R8rP4jg8.js";import{C as se}from"./Collapse-BsDTvhXW.js";import{T as m}from"./TextInput-BRteoBJL.js";import{S as h}from"./Select-uZaPD1q6.js";import"./get-style-object-DUJZA7T_.js";import"./InputBase-CS1WPbx0.js";import"./Input-ZQfrt0AG.js";import"./CheckIcon-CUDbF6ID.js";const ae="https://dianlucky.my.id/api";async function te(){return(await I.get(`${ae}/levels`,{headers:{Authorization:`Bearer ${B.getToken()}`}})).data.data}const Ae=()=>H({queryKey:["daily-task"],queryFn:()=>te()}),le="https://dianlucky.my.id/api";async function re(o,d){return(await I.patch(`${le}/accounts/${o}`,d,{headers:{Authorization:`Bearer ${B.getToken()}`}})).data}const ie=o=>W({mutationFn:d=>re(o,d)}),ke=()=>{const[o,{toggle:d}]=K(!1),[b,w]=n.useState(!1),[C,A]=n.useState(!1),[U,k]=n.useState(!1),[z,u]=n.useState(!1),[L,p]=n.useState(!1),[a,N]=n.useState();console.log("Account yang dipilih : ",a);const[y,O]=n.useState([]),{data:x,refetch:j,isLoading:E}=Z();n.useEffect(()=>{x&&O(x)},[x]),console.log("Data akun:",y);const R=y.slice().sort((s,i)=>s.status.localeCompare(i.status)).map((s,i)=>e.jsxs(t.Tr,{className:"text-center",children:[e.jsx(t.Td,{children:i+1}),e.jsx(t.Td,{children:s.username}),e.jsx(t.Td,{children:s.level}),e.jsx(t.Td,{children:e.jsxs(_,{radius:"xs",color:s.status=="Pegawai tetap"?"blue":s.status=="Part time"?"	#a46ede":"yellow",children:[" ",s.status]})}),e.jsx(t.Td,{className:"w-40 ",children:e.jsxs("div",{className:"flex gap-1 justify-center",children:[e.jsx(c,{size:"compact-sm",color:"yellow",onClick:()=>{p(!0),u(!1),N(s)},children:e.jsx(S,{})}),e.jsx(c,{size:"compact-sm",color:"red",onClick:()=>{u(!0),p(!1),N(s)},children:e.jsx(ee,{})})]})})]},i)),r=D({validateInputOnChange:!0,initialValues:{username:"",password:"",level:"",status:""},validate:{username:s=>s.length<5?"Minimal 10 karakter":null,password:s=>s.length<10?"Minimal 10 karakter":null}}),$=J(),F=async s=>{if(s.preventDefault(),!r.isValid())return;const i={username:r.values.username,password:r.values.password,level:r.values.level,status:r.values.status};await $.mutateAsync(i,{onSuccess:g=>{console.log("Success:",g),w(!0),r.reset(),j(),close(),setTimeout(()=>{w(!1)},4500)}})},l=D({validateInputOnChange:!0,initialValues:a??{username:"",password:"",level:"",status:""},validate:{username:s=>s.length<5?"Minimal 10 karakter":null}});n.useEffect(()=>{a&&l.setValues({username:a.username??"",password:a.password??"",level:a.level??"",status:a.status??""})},[a]);const M=ie(a==null?void 0:a.id),G=async s=>{s.preventDefault();const i={username:l.values.username,level:l.values.level,status:l.values.status};(l.values.password??"").trim()!==""&&(i.password=l.values.password),await M.mutateAsync(i,{onSuccess:g=>{console.log("Success:",g),k(!0),l.reset(),j(),close(),setTimeout(()=>{k(!1)},4500)}})},V=X(),q=async s=>{V.mutateAsync(s,{onSuccess:i=>{console.log("Success Delete:",i),A(!0),u(!1),j(),close(),setTimeout(()=>{A(!1)},4500)},onError:()=>{Y({message:"Gagal! Data ini berelasi ke tabel lain",color:"red",position:"bottom-right"})}})};return E?e.jsx(Q,{color:"blue",type:"dots"}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid lg:grid-cols-12 gap-6",children:[e.jsx("div",{className:"col-span-9",children:e.jsxs("section",{className:"bg-white shadow-lg p-6 rounded-lg",children:[e.jsx("div",{className:"flex",children:e.jsx("div",{children:e.jsx("div",{className:"text-dark font-semibold cursor-pointer text-lg",children:"Daftar akun"})})}),e.jsx("div",{className:"mt-3",children:e.jsxs(t,{striped:!0,highlightOnHover:!0,withTableBorder:!0,withColumnBorders:!0,className:"text-dark font-semibold cursor-pointer text-sm",children:[e.jsx(t.Thead,{children:e.jsxs(t.Tr,{children:[e.jsx(t.Th,{className:"font-semibold flex justify-center",children:"No"}),e.jsx(t.Th,{className:"font-semibold",style:{textAlign:"center"},children:"Username"}),e.jsx(t.Th,{className:"font-semibold",style:{textAlign:"center"},children:"Role"}),e.jsx(t.Th,{className:"font-semibold",style:{textAlign:"center"},children:"Status"}),e.jsx(t.Th,{className:"font-semibold flex justify-center",children:"Aksi"})]})}),e.jsx(t.Tbody,{children:R})]})})]})}),e.jsxs("div",{className:"col-span-3",children:[e.jsx("section",{className:"col-span-4 bg-white shadow-lg p-6 rounded-lg",children:e.jsxs("div",{children:[e.jsxs("div",{className:"grid grid-cols-12 gap-2",children:[e.jsx("div",{className:"col-span-10 text-dark font-semibold cursor-pointer text-lg mb-2",children:"Tambah akun"}),e.jsx("div",{className:"col-span-2 -mt-1",children:e.jsx(c,{color:"blue",className:"shadow-lg",size:"xs",onClick:d,children:e.jsx(S,{size:20,color:"black"})})})]}),e.jsx(f,{}),e.jsx("div",{className:"mt-2",children:e.jsx(se,{in:o,children:e.jsxs("form",{onSubmit:F,children:[e.jsx(m,{withAsterisk:!0,label:"Username",className:"mb-4",placeholder:"username",...r.getInputProps("username")},r.key("username")),e.jsx(m,{withAsterisk:!0,label:"Password",className:"mb-2",placeholder:"password",...r.getInputProps("password")},r.key("password")),e.jsx(h,{withAsterisk:!0,label:"Role",placeholder:"role",data:[{value:"Admin",label:"Admin"},{value:"Owner",label:"Owner"},{value:"Pegawai",label:"Pegawai"}],...r.getInputProps("level")}),e.jsx(h,{withAsterisk:!0,label:"Status",placeholder:"status",mt:8,data:[{value:"Pegawai tetap",label:"Pegawai tetap"},{value:"Part time",label:"Part time"},{value:"Owner",label:"Owner"},{value:"Admin",label:"Admin"}],...r.getInputProps("status")}),e.jsx("div",{className:"flex justify-center mt-5",children:e.jsx(c,{fullWidth:!0,type:"submit",children:"Simpan"})})]})})})]})}),z?e.jsx("section",{className:"col-span-4 bg-white shadow-lg p-6 rounded-lg mt-2",children:e.jsxs("div",{children:[e.jsxs("div",{className:"grid grid-cols-12",children:[e.jsx("div",{className:"col-span-10 text-dark font-semibold cursor-pointer text-lg mb-2",children:"Hapus akun"}),e.jsx(T,{onClick:()=>u(!1),className:"col-span-2 flex left-1"})]}),e.jsx(f,{}),e.jsxs("div",{className:"mt-4 text-center",children:[e.jsx(P,{size:"md",fw:500,children:"Apakah anda yakin ingin menghapus data akun dengan username ?"}),e.jsxs(P,{size:"md",c:"red",fw:600,children:['"',a==null?void 0:a.username,'"']})]}),e.jsx("div",{className:"flex justify-center mt-2",children:e.jsx(c,{onClick:()=>q(a==null?void 0:a.id),type:"submit",color:"red",children:"Ya!"})})]})}):L?e.jsx("section",{className:"col-span-4 bg-white shadow-lg p-6 rounded-lg mt-2",children:e.jsxs("div",{children:[e.jsxs("div",{className:"grid grid-cols-12",children:[e.jsx("div",{className:"col-span-10 text-dark font-semibold cursor-pointer text-lg mb-2",children:"Edit akun"}),e.jsx("div",{className:"col-span-1"}),e.jsx("div",{className:"col-span-1",children:e.jsx(T,{onClick:()=>p(!1)})})]}),e.jsx(f,{}),e.jsx("div",{className:"mt-4",children:e.jsxs("form",{onSubmit:G,children:[e.jsx(m,{label:"Username",className:"mb-4",placeholder:"username",...l.getInputProps("username")},l.key("username")),e.jsx(m,{label:"Password",className:"mb-4",placeholder:"password",...l.getInputProps("password")},l.key("password")),e.jsx(h,{withAsterisk:!0,label:"Role",placeholder:"role",data:[{value:"Admin",label:"Admin"},{value:"Owner",label:"Owner"},{value:"Pegawai",label:"Pegawai"}],...l.getInputProps("level")}),e.jsx(h,{withAsterisk:!0,label:"Status",placeholder:"status",mt:8,data:[{value:"Pegawai tetap",label:"Pegawai tetap"},{value:"Part time",label:"Part time"},{value:"Lain lain",label:"Lain lain"}],...l.getInputProps("status")}),e.jsx("div",{className:"flex justify-center mt-5",children:e.jsx(c,{fullWidth:!0,type:"submit",children:"Simpan"})})]})})]})}):""]})]}),e.jsxs("div",{className:"fixed bottom-4 right-4 z-50 w-100",children:[b&&e.jsx(v,{color:"teal",title:"Berhasil!",mt:"md",children:"Data berhasil ditambahkan"}),U&&e.jsx(v,{color:"teal",title:"Berhasil!",mt:"md",children:"Data berhasil diubah"}),C&&e.jsx(v,{color:"teal",title:"Berhasil!",mt:"md",children:"Data berhasil dihapus"})]})]})};export{ke as AccountPage,Se as getAccountById,De as getAllAccount,te as getAllLevel,Te as postAccount,J as useCreateAccount,X as useDeleteAccount,Ie as useGetAccountById,Z as useGetAllAccount,Ae as useGetAllLevel,ie as useUpdateAccountById};
