import{d as U,e as F,s as W,z as te,r as o,j as e,B as d,A as le,D as p,C as k,T as l,I as ie,c as D,N as w,$ as _,i as I}from"./index-D13YgGcN.js";import{u as ne,f as C}from"./createEmployee-DuwcPHdy.js";import{c as Le}from"./createEmployee-DuwcPHdy.js";import{u as ce}from"./getEmployee-C5mQaVzv.js";import{g as Oe}from"./getEmployee-C5mQaVzv.js";import{u as re}from"./getAccount-Dm-50p6j.js";import{u as B}from"./use-form-kV3fLffc.js";import{T as t}from"./Table-Cy81ZCkV.js";import{B as oe}from"./Badge-Bv-ZFimK.js";import{I as de}from"./IconInfoCircle-DmymbyJ6.js";import{I as P}from"./IconPencil-CcEAKxH1.js";import{I as me}from"./IconTrash-DRnPQ1Om.js";import{C as he}from"./Collapse-7dVXkzeb.js";import{T as g}from"./TextInput-DkgMRwT9.js";import{D as z}from"./DatePickerInput-BpfuYwbn.js";import{S as M}from"./Select-DWS_nW1X.js";import"./get-style-object-DUJZA7T_.js";import"./InputBase-BJOZdEhw.js";import"./Input-D0PCLz88.js";import"./use-dates-state-bq-nHO7L.js";import"./use-dates-input-C-vSrxcL.js";import"./DatePicker-BOHvZ15p.js";import"./CheckIcon-DUYkGu2C.js";const ue="https://dianlucky.my.id/api";async function pe(r,m){return(await F.patch(`${ue}/employees/${r}`,m,{headers:{Authorization:`Bearer ${W.getToken()}`}})).data}const xe=r=>U({mutationFn:m=>pe(r,m)}),je="https://dianlucky.my.id/api",ge=async r=>(console.log("Account id: ",r),(await F.delete(`${je}/employees/${r}`,{headers:{Authorization:`Bearer ${W.getToken()}`}})).data),fe=()=>U({mutationFn:r=>ge(r),onError:r=>{console.log(r)}}),$e=()=>{const[r,{toggle:m}]=te(!1),[y,E]=o.useState(!1),[$,A]=o.useState(!1),[V,T]=o.useState(!1),[R,h]=o.useState(!1),[L,x]=o.useState(!1),[G,j]=o.useState(!1),[s,f]=o.useState();console.log("Account yang dipilih : ",s),o.useEffect(()=>{var a,c;s&&i.setValues({name:s.name??"",birth_date:new Date(s.birth_date)??"",phone:((a=s.phone)==null?void 0:a.toString())??"",account_id:((c=s.account_id)==null?void 0:c.toString())??""})},[s]);const[O,H]=o.useState([]),{data:b}=re();o.useEffect(()=>{b&&H(b)},[b]);const S=O.map(a=>({value:a.id.toString(),label:a.username})),[Y,q]=o.useState([]),{data:N,refetch:v,isLoading:J}=ce();o.useEffect(()=>{N&&q(N)},[N]);const K=Y.slice().sort((a,c)=>a.account.status.localeCompare(c.account.status)).map((a,c)=>e.jsxs(t.Tr,{style:{textAlign:"center"},children:[e.jsx(t.Td,{children:c+1}),e.jsx(t.Td,{children:a.name}),e.jsx(t.Td,{children:a.phone}),e.jsx(t.Td,{children:e.jsxs(oe,{radius:"xs",color:a.account.status=="Pegawai tetap"?"blue":a.account.status=="Part time"?"	#a46ede":"yellow",children:[" ",a.account.status]})}),e.jsx(t.Td,{children:a.account.level}),e.jsx(t.Td,{className:"w-40 ",children:e.jsxs("div",{className:"flex gap-1 justify-center",children:[e.jsx(d,{size:"compact-sm",color:"indigo",onClick:()=>{j(!0),x(!1),h(!1),f(a)},children:e.jsx(de,{})}),e.jsx(d,{size:"compact-sm",color:"yellow",onClick:()=>{x(!0),j(!1),h(!1),f(a)},children:e.jsx(P,{})}),e.jsx(d,{size:"compact-sm",color:"red",onClick:()=>{h(!0),x(!1),j(!1),f(a)},children:e.jsx(me,{})})]})})]},c)),n=B({validateInputOnChange:!0,initialValues:{name:"",birth_date:new Date,phone:"",account_id:""},validate:{name:a=>a.length<10?"Minimal 10 karakter":null,birth_date:a=>a instanceof Date&&!isNaN(a.getTime())?null:"Tanggal tidak valid",phone:a=>a.length<11?"Minimal 11 karakter":null}}),Q=ne(),X=async a=>{if(a.preventDefault(),!n.isValid())return;const c={name:n.values.name,birth_date:C(n.values.birth_date),phone:n.values.phone,account_id:parseInt(n.values.account_id)};await Q.mutateAsync(c,{onSuccess:u=>{console.log("Success:",u),E(!0),n.reset(),v(),close(),setTimeout(()=>{E(!1)},4500)},onError:u=>{console.error("Error:",u),_({message:"Gagal menambahkan data",color:"red",position:"bottom-right"})}})},i=B({validateInputOnChange:!0,initialValues:s??{name:"",birth_date:new Date,phone:"",account_id:""},validate:{name:a=>a.length<8?"Minimal 8 karakter":null,phone:a=>a.length<11?"Minimal 11 karakter":null}}),Z=xe(s==null?void 0:s.id),ee=async a=>{if(a.preventDefault(),!i.isValid())return;const c={name:i.values.name,birth_date:C(i.values.birth_date),phone:i.values.phone,account_id:parseInt(i.values.account_id.toString())};await Z.mutateAsync(c,{onSuccess:u=>{console.log("Success:",u),T(!0),i.reset(),v(),close(),setTimeout(()=>{T(!1)},4500)}})},se=fe(),ae=async a=>{se.mutateAsync(a,{onSuccess:c=>{console.log("Success Delete:",c),A(!0),h(!1),v(),close(),setTimeout(()=>{A(!1)},4500)},onError:()=>{_({message:"Gagal! Data ini berelasi ke tabel lain",color:"red",position:"bottom-right"})}})};return J?e.jsx(le,{color:"blue",type:"dots"}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid lg:grid-cols-12 gap-6",children:[e.jsx("div",{className:"col-span-9",children:e.jsxs("section",{className:"bg-white shadow-lg p-6 rounded-lg",children:[e.jsx("div",{className:"flex",children:e.jsx("div",{children:e.jsx("div",{className:"text-dark font-semibold cursor-pointer text-lg",children:"Daftar pegawai"})})}),e.jsx("div",{className:"mt-3",children:e.jsxs(t,{striped:!0,highlightOnHover:!0,withTableBorder:!0,withColumnBorders:!0,className:"text-dark font-semibold cursor-pointer text-sm",children:[e.jsx(t.Thead,{children:e.jsxs(t.Tr,{children:[e.jsx(t.Th,{className:"font-semibold",style:{textAlign:"center"},children:"No"}),e.jsx(t.Th,{className:"font-semibold",style:{textAlign:"center"},children:"Nama"}),e.jsx(t.Th,{className:"font-semibold",style:{textAlign:"center"},children:"No. Whatsapp"}),e.jsx(t.Th,{className:"font-semibold",style:{textAlign:"center"},children:"Status"}),e.jsx(t.Th,{className:"font-semibold",style:{textAlign:"center"},children:"Role"}),e.jsx(t.Th,{className:"font-semibold flex justify-center",children:"Aksi"})]})}),e.jsx(t.Tbody,{children:K})]})})]})}),e.jsxs("div",{className:"col-span-3",children:[e.jsx("section",{className:"col-span-4 bg-white shadow-lg p-6 rounded-lg",children:e.jsxs("div",{children:[e.jsxs("div",{className:"grid grid-cols-12 gap-2",children:[e.jsx("div",{className:"col-span-10 text-dark font-semibold cursor-pointer text-lg mb-2",children:"Tambah pegawai"}),e.jsx("div",{className:"col-span-2 -mt-1",children:e.jsx(d,{color:"blue",className:"shadow-lg",size:"xs",onClick:m,children:e.jsx(P,{size:20,color:"black"})})})]}),e.jsx(p,{}),e.jsx("div",{className:"mt-2",children:e.jsx(he,{in:r,children:e.jsxs("form",{onSubmit:X,children:[e.jsx(g,{withAsterisk:!0,label:"Nama",placeholder:"Nama lengkap",...n.getInputProps("name")},n.key("name")),e.jsx(z,{label:"Tanggal lahir",placeholder:"Pick date",...n.getInputProps("birth_date"),onChange:a=>{a&&n.setFieldValue("birth_date",a)}},n.key("birth_date")),e.jsx(g,{withAsterisk:!0,label:"No. Whatsapp",placeholder:"No Whatsapp",...n.getInputProps("phone")},n.key("phone")),e.jsx(M,{withAsterisk:!0,label:"Akun yang digunakan",placeholder:"Akun",data:S,...n.getInputProps("account_id")}),e.jsx("div",{className:"flex justify-center mt-5",children:e.jsx(d,{fullWidth:!0,type:"submit",children:"Simpan"})})]})})})]})}),R?e.jsx("section",{className:"col-span-4 bg-white shadow-lg p-6 rounded-lg mt-2",children:e.jsxs("div",{children:[e.jsxs("div",{className:"grid grid-cols-12",children:[e.jsx("div",{className:"col-span-10 text-dark font-semibold cursor-pointer text-lg mb-2",children:"Hapus data pegawai"}),e.jsx("div",{className:"col-span-1"}),e.jsx("div",{className:"col-span-1",children:e.jsx(k,{onClick:()=>h(!1)})})]}),e.jsx(p,{}),e.jsxs("div",{className:"mt-4 text-center",children:[e.jsx(l,{size:"md",fw:500,children:"Apakah anda yakin ingin menghapus data pegawai dengan nama ?"}),e.jsxs(l,{size:"md",c:"red",fw:600,children:['"',s==null?void 0:s.name,'"']})]}),e.jsx("div",{className:"flex justify-center mt-2",children:e.jsx(d,{onClick:()=>ae(s==null?void 0:s.id),type:"submit",color:"red",children:"Ya!"})})]})}):L?e.jsx("section",{className:"col-span-4 bg-white shadow-lg p-6 rounded-lg mt-2",children:e.jsxs("div",{children:[e.jsxs("div",{className:"grid grid-cols-12",children:[e.jsx("div",{className:"col-span-10 text-dark font-semibold cursor-pointer text-lg mb-2",children:"Edit data pegawai"}),e.jsx("div",{className:"col-span-1"}),e.jsx("div",{className:"col-span-1",children:e.jsx(k,{onClick:()=>x(!1)})})]}),e.jsx(p,{}),e.jsx("div",{className:"mt-4",children:e.jsxs("form",{onSubmit:ee,children:[e.jsx(g,{withAsterisk:!0,label:"Nama",placeholder:"nama lengkap",...i.getInputProps("name")},i.key("name")),e.jsx(z,{label:"Tanggal lahir",placeholder:"Pick date",...i.getInputProps("birth_date"),onChange:a=>{a&&i.setFieldValue("birth_date",a)}},i.key("birth_date")),e.jsx(g,{withAsterisk:!0,label:"No. Whatsapp",placeholder:"No Whatsapp",...i.getInputProps("phone")},i.key("phone")),e.jsx(M,{withAsterisk:!0,label:"Akun yang digunakan",placeholder:"Akun",searchable:!0,data:S,...i.getInputProps("account_id")}),e.jsx("div",{className:"flex justify-center mt-5",children:e.jsx(d,{fullWidth:!0,type:"submit",children:"Simpan"})})]})})]})}):G?e.jsxs("section",{className:"col-span-4 bg-white shadow-lg p-6 rounded-lg mt-2 mb-10",children:[e.jsxs("div",{className:"grid grid-cols-12",children:[e.jsx("div",{className:"col-span-10 text-dark font-semibold cursor-pointer text-lg mb-2",children:"Detail pegawai"}),e.jsx("div",{className:"col-span-1"}),e.jsx("div",{className:"col-span-1",children:e.jsx(k,{onClick:()=>j(!1)})})]}),e.jsx(p,{}),e.jsxs("div",{className:"mt-4",children:[e.jsxs("div",{className:"grid grid-cols-12",children:[e.jsx("div",{className:"col-span-4 flex justify-center -ml-5",children:e.jsx(ie,{radius:"200",src:"/images/profile-default.png",style:{width:"70px",height:"70px",objectFit:"cover"}})}),e.jsxs("div",{className:"col-span-8",children:[e.jsx("div",{className:"mt-2",children:e.jsx(l,{fw:"bold",size:"lg",truncate:"end",children:s==null?void 0:s.name})}),e.jsx("div",{className:"-mt-2",children:e.jsx(l,{children:s==null?void 0:s.account.level})})]})]}),e.jsxs("div",{className:"grid grid-cols-12 px-2",children:[e.jsx("div",{className:"col-span-6",children:e.jsxs("div",{className:"mt-5",children:[e.jsx(l,{children:"Username:"}),e.jsx(l,{fw:"bold",mt:-5,children:s==null?void 0:s.account.username})]})}),e.jsx("div",{className:"col-span-6",children:e.jsxs("div",{className:"mt-5",children:[e.jsx(l,{children:"Role:"}),e.jsx(l,{fw:"bold",mt:-5,children:s==null?void 0:s.account.level})]})}),e.jsx("div",{className:"col-span-6",children:e.jsxs("div",{className:"mt-5",children:[e.jsx(l,{children:"Status:"}),e.jsx(l,{fw:"bold",mt:-5,children:s==null?void 0:s.account.status})]})}),e.jsx("div",{className:"col-span-6",children:e.jsxs("div",{className:"mt-5",children:[e.jsx(l,{children:"No Whatsapp:"}),e.jsx(l,{fw:"bold",mt:-5,children:s==null?void 0:s.phone})]})}),e.jsx("div",{className:"col-span-12",children:e.jsxs("div",{className:"mt-5",children:[e.jsx(l,{children:"Tanggal lahir:"}),e.jsx(l,{fw:"bold",mt:-5,children:(s==null?void 0:s.birth_date)&&D(new Date(s.birth_date),"EEEE, dd MMMM yyyy",{locale:I})})]})})]}),e.jsx(p,{mt:7}),e.jsxs("div",{className:"mt-2 px-2 flex gap-2",children:[e.jsx(l,{fw:400,size:"sm",children:"Tgl dibuat :"}),e.jsx(l,{fw:700,size:"sm",children:(s==null?void 0:s.created_at)&&D(new Date(s.created_at),"EEEE, dd MMMM yyyy",{locale:I})})]})]})]}):""]})]}),e.jsxs("div",{className:"fixed bottom-4 right-4 z-50 w-100",children:[y&&e.jsx(w,{color:"teal",title:"Berhasil!",mt:"md",children:"Data berhasil ditambahkan"}),V&&e.jsx(w,{color:"teal",title:"Berhasil!",mt:"md",children:"Data berhasil diubah"}),$&&e.jsx(w,{color:"teal",title:"Berhasil!",mt:"md",children:"Data berhasil dihapus"})]})]})};export{$e as EmployeePage,Le as createEmployee,Oe as getAllEmployee,ne as useCreateEmployee,fe as useDeleteEmployee,ce as useGetAllEmployee,xe as useUpdateEmployeeById};
