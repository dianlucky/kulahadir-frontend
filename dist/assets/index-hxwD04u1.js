import{b as B,l as _,j as e,c as M,P as W,B as g,D as I,I as U,T as c,i as A,e as D,s as E,k as V,d as F,h as X,z as K,r as x,U as S,$ as N,a5 as Z}from"./index-WTq-jBmO.js";import{S as y}from"./Skeleton-D6fO1EK0.js";import{I as ee}from"./IconCalendar-a5o3o5ow.js";import{D as se}from"./DatePicker-KQw2JWcj.js";import{I as ne,u as ie}from"./getIncomingDetail-CHK4fXVd.js";import{g as Ve,a as Xe,b as Ze}from"./getIncomingDetail-CHK4fXVd.js";import{I as te}from"./IconInfoCircle-Ds01HTm7.js";import{I as q}from"./IconChevronLeft-CpJ0R4r6.js";import{I as ae}from"./IconPlus-Y1sj9bFE.js";import{T as P}from"./TextInput-BhsxxCwZ.js";import{I as oe,u as ce}from"./getItem-jCacMLKD.js";import{D as Y,I as J,a as O}from"./IconSquareChevronRightFilled-BEfKFGHO.js";import"./use-dates-state-D9bGxs59.js";import"./InputBase-D3mEq3x3.js";import"./Input-D56DVYoT.js";const le=({setSelectedDate:s,incomingData:i,LoadingIncomingData:a,selectedDate:j})=>{const h=B(),u=_();return e.jsx(e.Fragment,{children:e.jsxs("section",{className:"bg-white mx-auto max-w-sm w-full shadow-lg rounded-md relative p-4",children:[e.jsxs("div",{className:"flex justify-between text-xs items-center mb-2",children:[a?e.jsx(y,{height:10,width:"80%"}):e.jsxs("span",{className:"text-sm font-bold text-brown",children:["Barang masuk,"," ",M(new Date,"EEEE, dd MMM yyyy",{locale:A})]}),e.jsxs(W,{width:300,position:"bottom-end",offset:4,withArrow:!0,shadow:"lg",children:[e.jsx(W.Target,{children:e.jsx(g,{size:"compact-sm",color:"#654433",children:e.jsx(ee,{size:22})})}),e.jsx(W.Dropdown,{children:e.jsx("div",{className:"flex justify-center",children:e.jsx(se,{size:"sm",value:j,onChange:s})})})]})]}),e.jsx(I,{size:"xs",className:"mb-2"}),i.length==0&&e.jsxs("div",{className:"my-10",children:[e.jsx("div",{className:"flex justify-center",children:e.jsx(U,{radius:"10px",h:120,w:120,src:"/images/not-found.svg"})}),e.jsx("div",{className:"text-center mt-1",children:e.jsx(c,{size:"sm",fw:600,children:"Data tidak ditemukan"})})]}),i.map((d,k)=>e.jsxs("div",{children:[e.jsxs("div",{className:" px-3",children:[e.jsxs("div",{className:"col-span-12 flex justify-between",children:[e.jsxs("div",{children:[a?e.jsx(y,{height:10,width:"80%"}):e.jsx(c,{size:"xs",fw:400,children:M(d.created_at,"EEEE, dd MMM yyyy HH:mm",{locale:A})}),e.jsx("div",{className:"mt-1",children:a?e.jsx(y,{height:10,width:"50%"}):e.jsxs("div",{className:"flex",children:[e.jsx(ne,{size:16,color:"#40c057"}),e.jsx(c,{size:"sm",c:"#40c057",fw:800,mt:-2,ml:3,children:"Stok masuk"})]})})]}),e.jsx("div",{className:"",children:e.jsx(g,{size:"compact-xs",color:"blue",onClick:()=>{h(`/${u.pathname.includes("frozen")?"frozen":"warehouse"}-inventory/incoming/detail`,{state:{data:d}})},children:e.jsx(te,{size:17,color:"white"})})})]}),d.details.map((C,l)=>e.jsxs("div",{className:"grid grid-cols-12",children:[e.jsx("div",{className:"col-span-6 mt-1",children:a?e.jsx(y,{height:10,width:"50%"}):e.jsx(c,{size:"sm",fw:500,children:C.item.name})}),e.jsx("div",{className:"col-span-6 text-end",children:a?e.jsx("div",{className:"flex justify-end",children:e.jsx(y,{height:10,width:"10%"})}):e.jsx(c,{size:"md",fw:600,mr:10,children:C.amount})})]},l))]}),e.jsx("div",{className:"my-2",children:e.jsx(I,{})})]},k))]})})},re="https://dianlucky.my.id/api";async function de(s){return(await D.get(`${re}/incoming-items/by-date?dateString=${s}`,{headers:{Authorization:`Bearer ${E.getToken()}`}})).data.data}const me=s=>V({queryKey:["item",s],queryFn:()=>de(s)}),xe="https://dianlucky.my.id/api",he=async s=>(await D.post(`${xe}/incoming-details/`,s,{headers:{Authorization:`Bearer ${E.getToken()}`}})).data,ue=()=>F({mutationFn:he,onMutate:async()=>{},onError:s=>{console.log("Error :",s)}}),je="https://dianlucky.my.id/api",pe=async s=>(await D.post(`${je}/incoming-items/`,s,{headers:{Authorization:`Bearer ${E.getToken()}`}})).data,ge=()=>F({mutationFn:pe,onMutate:async()=>{},onError:s=>{console.log("Error :",s)}}),fe="https://dianlucky.my.id/api",ye=async s=>(await D.delete(`${fe}/incoming-items/${s}`,{headers:{Authorization:`Bearer ${E.getToken()}`}})).data,we=()=>F({mutationFn:s=>ye(s),onError:s=>{console.log(s)}}),ve="https://dianlucky.my.id/api",be=async s=>(await D.delete(`${ve}/incoming-details/${s}`,{headers:{Authorization:`Bearer ${E.getToken()}`}})).data,Ne=()=>F({mutationFn:s=>be(s),onError:s=>{console.log(s)}}),ke="https://dianlucky.my.id/api";async function ze(s,i){return(await D.patch(`${ke}/incoming-details/${s}`,i,{headers:{Authorization:`Bearer ${E.getToken()}`}})).data}const Ie=s=>F({mutationFn:i=>ze(s,i)}),Se="/images/splash.png",Ce="https://dianlucky.my.id/api",Be=({items:s,LoadingItems:i})=>{const{creds:a}=X(),j=B(),[h,{open:u,close:d}]=K(!1),[k,C]=x.useState(0),[l,r]=x.useState(null),[p,f]=x.useState(0);x.useEffect(()=>{l&&C(l.stock+p)},[p,l]);const[w,L]=x.useState(""),[z,T]=x.useState([]),G=ge(),H=ue(),R=async()=>{if(z.length===0)return;const n=(a==null?void 0:a.employee_id)??1;try{const o=(await G.mutateAsync({employee_id:n})).data.id;for(const m of z)await H.mutateAsync({employee_id:n,item_id:m.item_id,incoming_id:o,amount:m.amount});T([]),r(null),f(0),N({message:"Berhasil menambahkan data",color:"green",position:"top-center"}),j(-1)}catch(t){console.error(t),N({message:"Gagal menambahkan data!",color:"red",position:"top-center"})}};return e.jsxs(e.Fragment,{children:[e.jsxs("section",{className:"bg-white shadow-md rounded-lg p-2",children:[e.jsx("div",{className:"flex justify-between px-2",children:e.jsx(P,{leftSectionPointerEvents:"none",leftSection:e.jsx(oe,{size:16}),placeholder:"Cari barang ...",radius:"md",size:"sm",value:w??"",onChange:n=>L(n.currentTarget.value)})}),e.jsxs("div",{className:"mt-4",children:[s.filter(n=>n.name.toLowerCase().includes(w?w.toLowerCase():"")).map((n,t)=>e.jsxs("div",{children:[e.jsxs(S,{className:"w-full grid grid-cols-12",onClick:()=>{const o=z.find(m=>m.item_id===n.id);f(0),o&&f(o.amount),r(n),u()},children:[e.jsx("div",{className:"col-span-2 flex justify-center",children:i?e.jsx(y,{height:40,width:"80%"}):e.jsx(U,{radius:"10px",h:35,w:35,src:n.image?`${Ce}/uploads/items/${n.image}`:Se})}),e.jsxs("div",{className:"col-span-8 text-left",children:[i?e.jsx(y,{height:10,width:"80%"}):e.jsx(c,{size:"sm",truncate:"end",fw:700,children:n.name}),i?e.jsx(y,{height:10,width:"20%",mt:16}):e.jsx(c,{size:"xs",truncate:"end",fw:400,mt:-4,children:n.code})]}),e.jsx("div",{className:"col-span-2 text-center my-auto",children:i?e.jsx("div",{className:"flex justify-end mr-3 -mt-2",children:e.jsx(y,{height:23,width:"40%"})}):e.jsx("div",{children:(()=>{const o=z.find(m=>m.item_id===n.id);return o?e.jsxs("div",{children:[e.jsx(c,{size:"md",fw:700,children:n.stock}),e.jsxs(c,{size:"sm",c:"green",fw:600,mt:-4,mr:4,children:["+",o.amount]})]}):e.jsx(c,{size:"xl",fw:700,children:n.stock})})()})})]}),e.jsx("div",{className:"px-2",children:e.jsx(I,{my:10})})]},t)),e.jsx(Y,{opened:h,onClose:d,position:"bottom",withCloseButton:!1,size:"xs",children:e.jsxs("div",{className:"p-3",children:[e.jsxs("div",{className:"text-center",children:[e.jsx(c,{size:"md",fw:500,children:l==null?void 0:l.name}),e.jsx(I,{my:7})]}),e.jsxs("div",{className:"flex gap-2 mb-4",children:[e.jsx(P,{label:"Stok awal",size:"sm",disabled:!0,value:(l==null?void 0:l.stock)??0}),e.jsx(P,{label:"Stok akhir",size:"sm",disabled:!0,value:k??0})]}),e.jsxs("div",{className:"grid grid-cols-12 text-center",children:[e.jsx("div",{className:"col-span-4 my-auto",children:e.jsx(S,{size:"xl",disabled:p<=0,onClick:()=>f((p??0)-1),children:e.jsx(J,{size:40,color:"#4B352A"})})}),e.jsx("div",{className:"col-span-4",children:e.jsx(c,{size:"60px",c:"green",fw:700,children:p})}),e.jsx("div",{className:"col-span-4 my-auto",children:e.jsx(S,{size:"xl",onClick:()=>f(n=>n+1),children:e.jsx(O,{size:40,color:"#4B352A"})})})]}),e.jsxs("div",{className:"flex justify-between gap-2 mt-8 -mx-3",children:[e.jsx(g,{fullWidth:!0,size:"sm",color:"gray",onClick:d,children:"Batal"}),e.jsx(g,{fullWidth:!0,size:"sm",onClick:()=>{l&&p>0&&T(n=>{const t=n.findIndex(o=>o.item_id===l.id);if(t!==-1){const o=[...n];return o[t].amount=p,o}return[...n,{item_id:l.id,amount:p}]}),d()},children:"Simpan"})]})]})})]})]}),e.jsx("div",{className:"fixed bottom-22 right-4 z-10 w-32",children:e.jsx(g,{size:"sm",disabled:z.length==0,fullWidth:!0,onClick:R,children:"Simpan"})})]})},Q="https://dianlucky.my.id/api",De="/images/profile-default.png",Ee=({incomingData:s,details:i,RefetchDetails:a})=>{var n;const j=B(),[h,{open:u,close:d}]=K(!1),[k,{open:C,close:l}]=K(!1),[r,p]=x.useState(),[f,w]=x.useState((r==null?void 0:r.amount)??0);x.useEffect(()=>{w(r==null?void 0:r.amount)},[r]);const L=we(),z=async t=>{L.mutateAsync(t,{onSuccess:o=>{console.log("Sukses :",o),N({message:"Data barang masuk berhasil dihapus",color:"green",position:"top-center"}),d(),j(-1)},onError:o=>{var v,b;const m=o,$=((b=(v=m==null?void 0:m.response)==null?void 0:v.data)==null?void 0:b.errors)||"Gagal menghapus kategori. Silakan coba lagi.";d(),N({message:$,color:"red",position:"top-center"})}})},T=Ne(),G=async t=>{T.mutateAsync(t,{onSuccess:()=>{a(),N({message:"Detail barang masuk berhasil dihapus",color:"green",position:"top-center"}),l()},onError:o=>{var v,b;const m=o,$=((b=(v=m==null?void 0:m.response)==null?void 0:v.data)==null?void 0:b.errors)||"Gagal menghapus detail. Silakan coba lagi.";d(),N({message:$,color:"red",position:"top-center"})}})},H=Ie(r==null?void 0:r.id),R=async()=>{const t={amount:f};await H.mutateAsync(t,{onSuccess:()=>{a(),l(),N({message:"Detail berhasil diubah",color:"green",position:"top-center"}),w(0)},onError:o=>{var v,b;const m=o,$=((b=(v=m==null?void 0:m.response)==null?void 0:v.data)==null?void 0:b.errors)||"Gagal mengubah detail. Silakan coba lagi.";l(),N({message:$,color:"red",position:"top-center"})}})};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-white shadow-md rounded-md p-4",children:[e.jsxs("div",{className:"grid grid-cols-12",children:[e.jsx("div",{className:"col-span-6",children:e.jsx(c,{size:"xs",fw:400,children:M(s.created_at,"EEEE, dd MMM yyyy HH:mm",{locale:A})})}),e.jsxs("div",{className:"col-span-6 flex justify-end",children:[e.jsx(U,{radius:"10px",h:20,w:20,src:s.employee.profile_pic?`${Q}/uploads/employees/${(n=s.employee)==null?void 0:n.profile_pic}`:De}),e.jsx(c,{size:"xs",fw:400,truncate:"end",children:s.employee.name})]})]}),e.jsx(I,{my:8}),i.map((t,o)=>e.jsx(S,{onClick:()=>{C(),p(t)},className:"w-full mb-3 px-2",children:e.jsxs("div",{className:"grid grid-cols-12",children:[e.jsx("div",{className:"col-span-2",children:e.jsx(U,{radius:"10px",h:35,w:35,src:t.item.image?`${Q}/uploads/items/${t.item.image}`:"/images/splash.png"})}),e.jsxs("div",{className:"col-span-8",children:[e.jsx(c,{size:"sm",fw:600,children:t.item.name}),e.jsx(c,{size:"xs",fw:300,children:t.item.code})]}),e.jsx("div",{className:"col-span-2 text-end",children:e.jsx(c,{size:"xl",fw:700,mr:3,children:t.amount})})]})},o)),e.jsx(I,{}),e.jsxs("div",{className:"flex justify-between gap-2 mt-3",children:[e.jsx(g,{size:"xs",color:"gray",onClick:()=>{j(-1)},fullWidth:!0,children:"Kembali"}),e.jsx(g,{size:"xs",color:"red",onClick:()=>{u()},fullWidth:!0,children:"Hapus"})]})]}),e.jsx(Z,{opened:h,onClose:d,title:"Konfirmasi hapus",children:e.jsxs("div",{className:"px-1",children:[e.jsxs("div",{className:" text-center px-2",children:[e.jsx(c,{size:"sm",fw:500,children:"Apakah anda yakin ingin menghapus seluruh transaksi ini?"}),e.jsxs(c,{size:"sm",c:"red",fw:700,children:['"',M(s.created_at,"EEEE dd MMM yyyy HH:mm",{locale:A})," ","|| ",s.details.length,' Barang "']})]}),e.jsxs("div",{className:"flex justify-betwen gap-2 mt-2 mb-2",children:[e.jsx(g,{color:"grey",size:"xs",fullWidth:!0,onClick:d,children:"Kembali"}),e.jsx(g,{color:"yellow",size:"xs",fullWidth:!0,onClick:()=>{z(s==null?void 0:s.id)},children:"Ya! Hapus"})]})]})}),e.jsx(Y,{opened:k,onClose:()=>{l(),p(void 0)},position:"bottom",withCloseButton:!1,size:"xs",children:e.jsxs("div",{className:"p-3",children:[e.jsxs("div",{className:"text-center",children:[e.jsx(c,{size:"md",fw:500,children:r==null?void 0:r.item.name}),e.jsx(I,{my:7})]}),e.jsxs("div",{className:"grid grid-cols-12 text-center",children:[e.jsx("div",{className:"col-span-4 my-auto",children:e.jsx(S,{size:"xl",disabled:(f??0)<=1,onClick:()=>w(t=>(t??0)-1),children:e.jsx(J,{size:40,color:"#4B352A"})})}),e.jsx("div",{className:"col-span-4",children:e.jsx(c,{size:"60px",c:"green",fw:700,children:f})}),e.jsx("div",{className:"col-span-4 my-auto",children:e.jsx(S,{size:"xl",onClick:()=>w(t=>(t??0)+1),children:e.jsx(O,{size:40,color:"#4B352A"})})})]}),e.jsxs("div",{className:"flex justify-between gap-2 mt-12 -mx-3",children:[e.jsx(g,{fullWidth:!0,size:"sm",color:"red",onClick:()=>{G(r==null?void 0:r.id)},children:"Hapus"}),e.jsx(g,{fullWidth:!0,size:"sm",color:"blue",onClick:()=>{R()},children:"Ubah"})]})]})})]})},qe=()=>{const s=B(),i=_(),[a,j]=x.useState(new Date),[h,u]=x.useState([]),{data:d,isLoading:k}=me(M(a??new Date,"yyyy-MM-dd",{locale:A}));return x.useEffect(()=>{u(d||[])}),e.jsxs(e.Fragment,{children:[e.jsx("section",{className:"w-full h-20 bg-brown rounded-b-3xl"}),e.jsx("section",{className:"bg-white mx-5 p-3 shadow-md rounded-lg flex flex-col gap-2 -mt-10",children:e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{children:e.jsx(q,{onClick:()=>{s(-1)},size:21,className:"font-bold rounded-md"})}),e.jsx("div",{className:"font-semibold text-brown",children:e.jsxs("h2",{className:"font-semibold ",children:["Kelola Stok Masuk"," ",i.pathname.includes("frozen")?"Frozen":"Gudang"]})}),e.jsx("div",{children:e.jsx("div",{className:"mr-2",children:e.jsx(S,{onClick:()=>s(`/${i.pathname.includes("frozen")?"frozen":"warehouse"}-inventory/incoming/add`),children:e.jsx(ae,{size:22})})})})]})}),e.jsx("section",{children:e.jsx("div",{className:"mt-2 px-7 mb-20",children:e.jsx(le,{setSelectedDate:j,incomingData:h,LoadingIncomingData:k,selectedDate:a})})})]})},Qe=()=>{const s=B(),i=_(),[a,j]=x.useState([]),{data:h,isLoading:u}=ce(i.pathname.includes("frozen")?"Frozen":"!Frozen");return x.useEffect(()=>{j(h||[])},[h]),console.log(a),e.jsxs(e.Fragment,{children:[e.jsx("section",{className:"w-full h-20 bg-brown rounded-b-3xl"}),e.jsx("section",{className:"bg-white mx-5 p-3 shadow-md rounded-lg flex flex-col gap-2 -mt-10",children:e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{children:e.jsx(q,{onClick:()=>{s(-1)},size:21,className:"font-bold rounded-md"})}),e.jsx("div",{className:"font-semibold text-brown",children:e.jsx("h2",{className:"font-semibold ",children:"Tambah barang masuk"})}),e.jsx("div",{})]})}),e.jsx("div",{className:"mx-5 mt-2 mb-20",children:e.jsx(Be,{items:a,LoadingItems:u})})]})},Ye=()=>{const s=B(),a=_().state.data,[j,h]=x.useState([]),{data:u,refetch:d}=ie(a.id);return x.useEffect(()=>{h(u||[])},[u]),e.jsxs(e.Fragment,{children:[e.jsx("section",{className:"w-full h-20 bg-brown rounded-b-3xl"}),e.jsx("section",{className:"bg-white mx-5 p-3 shadow-md rounded-lg flex flex-col gap-2 -mt-10",children:e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{children:e.jsx(q,{onClick:()=>{s(-1)},size:21,className:"font-bold rounded-md"})}),e.jsx("div",{className:"font-semibold text-brown",children:e.jsx("h2",{className:"font-semibold",children:"Detail Barang Masuk"})}),e.jsx("div",{children:e.jsx("div",{className:"mr-2"})})]})}),e.jsx("section",{children:e.jsx("div",{className:"mt-2 px-5 mb-20",children:e.jsx(Ee,{incomingData:a,details:j,RefetchDetails:d})})})]})};export{Qe as AddIncomingStock,Ee as DetailIncomingSection,Ye as DetailIncomingStock,le as HistoryIncomingSection,qe as IncomingStockPage,Be as IncomingStockSection,Ve as getDetailByIncomingId,Xe as getDetailByItemId,de as getIncomingByDate,he as postIncomingDetail,pe as postIncomingItem,ue as useCreateIncomingDetail,ge as useCreateIncomingItem,we as useDeleteIncomingData,Ne as useDeleteIncomingDetail,ie as useGetDetailByIncomingId,me as useGetIncomingByDate,Ze as useGetIncomingDetailByItemId,Ie as useUpdateIncomingDetail};
