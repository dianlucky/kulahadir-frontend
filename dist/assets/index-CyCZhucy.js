import{g as P,j as e,L as R,T as p,c as N,P as _,B as g,D as v,i as S,z as T,r as c,a5 as z,$ as E,k as X,e as ee,s as se,b as A,U as L}from"./index-DhziyjX6.js";import{I as ae}from"./IconCalendarCheck-A1rtQBN6.js";import{D as le}from"./DatePicker-CbY-u6CD.js";import{S as w}from"./Skeleton-BhEmWU6Z.js";import{I as te}from"./IconSquareCheckFilled-Du0mZcRY.js";import{I as K}from"./IconChevronLeft-C3Qxla_q.js";import{t as ie,s as ne}from"./index-DqK5uH1A.js";import{b as ce,e as oe,u as H,a as re,c as de,d as me,M as ue}from"./deleteTaskEmployee-Dha3dyuh.js";import{I as q}from"./IconTrash-B03RvnVl.js";import{u as W}from"./use-form-BmKDidqr.js";import{I as F}from"./IconPlus-CLFgin2F.js";import{T as xe}from"./TextInput-C_mclD3l.js";import{T as he}from"./Textarea-CKjVOl78.js";import{u as pe}from"./getEmployee-Dgj6vptt.js";import{S as I}from"./Select-BAmYL70K.js";import"./use-dates-state-BgkaIGkW.js";import"./addDays-BZLHcBmN.js";import"./InputBase-BWEPP0b6.js";import"./Input-Dm5-gGl7.js";import"./CheckIcon-P4tLnAac.js";/**
 * @license @tabler/icons-react v3.34.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var $=P("outline","clipboard-list","IconClipboardList",[["path",{d:"M9 5h-2a2 2 0 0 0 -2 2v12a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-12a2 2 0 0 0 -2 -2h-2",key:"svg-0"}],["path",{d:"M9 3m0 2a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v0a2 2 0 0 1 -2 2h-2a2 2 0 0 1 -2 -2z",key:"svg-1"}],["path",{d:"M9 12l.01 0",key:"svg-2"}],["path",{d:"M13 12l2 0",key:"svg-3"}],["path",{d:"M9 16l.01 0",key:"svg-4"}],["path",{d:"M13 16l2 0",key:"svg-5"}]]);/**
 * @license @tabler/icons-react v3.34.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var je=P("outline","user-check","IconUserCheck",[["path",{d:"M8 7a4 4 0 1 0 8 0a4 4 0 0 0 -8 0",key:"svg-0"}],["path",{d:"M6 21v-2a4 4 0 0 1 4 -4h4",key:"svg-1"}],["path",{d:"M15 19l2 2l4 -4",key:"svg-2"}]]);/**
 * @license @tabler/icons-react v3.34.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var ge=P("filled","square-filled","IconSquareFilled",[["path",{d:"M19 2h-14a3 3 0 0 0 -3 3v14a3 3 0 0 0 3 3h14a3 3 0 0 0 3 -3v-14a3 3 0 0 0 -3 -3z",key:"svg-0"}]]);const fe=()=>e.jsxs("div",{className:"grid grid-cols-12 gap-4",children:[e.jsx("div",{className:"col-span-6",children:e.jsx(R,{to:"/daily-task-data",children:e.jsx("div",{className:"bg-white rounded-lg shadow-lg p-3",children:e.jsx("div",{className:"flex justify-center",children:e.jsxs("div",{children:[e.jsx($,{size:40,color:"#654433",className:"mx-auto"}),e.jsx(p,{size:"sm",c:"#654433",fw:700,mt:7,children:"Tugas harian"})]})})})})}),e.jsx("div",{className:"col-span-6",children:e.jsx(R,{to:"/task-employee-data",children:e.jsx("div",{className:"bg-white rounded-lg shadow-lg p-3",children:e.jsx("div",{className:"flex justify-center",children:e.jsxs("div",{children:[e.jsx(je,{size:40,color:"#654433",className:"mx-auto"}),e.jsx(p,{size:"sm",c:"#654433",fw:700,mt:7,children:"Tugas Pegawai"})]})})})})})]}),ye=({dailyTask:i,selectedDate:u,setSelectedDate:m,formattedDate:o,LoadingDailyTaskEmployee:r})=>{const t=n=>n.reduce((s,a)=>{const d=a.task_employee.employee.name;return s[d]||(s[d]=[]),s[d].push(a),s},{}),l=Array(6).fill(null);return e.jsxs("section",{className:"bg-white mx-auto max-w-sm w-full shadow-lg rounded-xl z-50 relative p-4",children:[e.jsxs("div",{className:"flex justify-between text-xs items-center mb-2",children:[e.jsxs("span",{className:"text-base font-bold text-brown",children:["Tugas Hari"," ",N(new Date(u??o),"EEEE, dd MMM yyyy",{locale:S})]}),e.jsxs(_,{width:300,position:"bottom-end",offset:4,withArrow:!0,shadow:"lg",children:[e.jsx(_.Target,{children:e.jsx(g,{size:"compact-sm",color:"#654433",children:e.jsx(ae,{size:22})})}),e.jsx(_.Dropdown,{children:e.jsx("div",{className:"flex justify-center",children:e.jsx(le,{size:"sm",value:u,onChange:m})})})]})]}),e.jsx(v,{size:"xs",className:"mb-2"}),r&&e.jsxs("div",{children:[e.jsxs("div",{className:"grid grid-cols-12 px-1",children:[e.jsx("div",{className:"col-span-1 m-auto -mb-7",children:e.jsx(w,{height:30,circle:!0,mb:"xl"})}),e.jsx("div",{className:"col-span-1 ml-1",children:e.jsx("div",{className:"w-px h-full bg-gray-300 mx-4"})}),e.jsxs("div",{className:"col-span-9 ml-1 my-auto",children:[e.jsx(w,{height:8,radius:"xl"}),e.jsx(w,{height:8,mt:2,width:"40%",radius:"xl"})]})]}),l.map((n,s)=>e.jsxs("div",{children:[e.jsx("div",{className:"my-2",children:e.jsx(v,{labelPosition:"left"})}),e.jsxs("div",{className:"grid grid-cols-12 px-1",children:[e.jsx("div",{className:"col-span-1 m-auto -mb-7",children:e.jsx(w,{height:30,circle:!0,mb:"xl"})}),e.jsx("div",{className:"col-span-1 ml-1",children:e.jsx("div",{className:"w-px h-full bg-gray-300 mx-4"})}),e.jsxs("div",{className:"col-span-9 ml-1 my-auto",children:[e.jsx(w,{height:8,radius:"xl"}),e.jsx(w,{height:8,mt:2,width:"40%",radius:"xl"})]})]})]},s))]}),i.length!=0&&!r&&Object.entries(t(i)).map(([n,s])=>e.jsxs("div",{children:[e.jsx("div",{className:"my-2",children:e.jsx(v,{label:n,labelPosition:"left"})}),s.map((a,d)=>e.jsxs("div",{children:[e.jsxs("div",{className:"grid grid-cols-12 px-1",children:[e.jsx("div",{className:"col-span-1 m-auto",children:e.jsx(p,{fw:700,size:"sm",children:a.task_employee.task.task_code})}),e.jsx("div",{className:"col-span-1 ml-1",children:e.jsx("div",{className:"w-px h-full bg-gray-300 mx-4"})}),e.jsx("div",{className:"col-span-9 ml-1 my-auto",children:e.jsx(p,{size:"12px",lineClamp:2,children:a.task_employee.task.task_name})}),e.jsxs("div",{className:"col-span-1 ",children:[a.status=="Belum"&&e.jsx("div",{style:{marginLeft:"-2px"},children:e.jsx(ge,{color:"grey"})}),a.status=="Sudah"&&e.jsx("div",{style:{marginLeft:"-2px"},children:e.jsx(te,{color:"#77B254"})})]})]}),e.jsx("div",{className:"mt-2 mb-2",children:e.jsx(v,{})})]},d))]},n))]})},ve=({dailyTask:i,refetchDailyTask:u})=>{const[m,{open:o,close:r}]=T(!1),[t,l]=c.useState(),n=ce(),s=async a=>{n.mutateAsync(a,{onSuccess:d=>{console.log("Sukses :",d),u(),E({message:"Tugas harian berhasil dihapus",color:"green",position:"top-center"}),r()}})};return e.jsxs("section",{className:"bg-white mx-auto max-w-sm w-full shadow-lg rounded-md relative p-4",children:[e.jsxs("div",{className:"flex justify-between text-xs items-center mb-2",children:[e.jsx("span",{className:"text-base font-bold text-brown",children:"Data Tugas Harian"}),e.jsx($,{size:28})]}),e.jsx(v,{size:"xs",className:"mb-2"}),i.length!=0&&i.map((a,d)=>e.jsxs("div",{children:[e.jsxs("div",{className:"grid grid-cols-12 px-2",children:[e.jsx("div",{className:"col-span-1 m-auto",children:e.jsx(p,{fw:700,size:"sm",children:a.task_code})}),e.jsx("div",{className:"col-span-1 ml-1",children:e.jsx("div",{className:"w-px h-full bg-gray-300 mx-4"})}),e.jsx("div",{className:"col-span-9 ml-1 my-auto",children:e.jsx(p,{size:"12px",lineClamp:2,children:a.task_name})}),e.jsx("div",{className:"col-span-1",children:e.jsx(g,{color:"red",size:"compact-sm",onClick:()=>{o(),l(a)},children:e.jsx(q,{size:18})})})]}),e.jsx("div",{className:"mt-2 mb-2",children:e.jsx(v,{})})]},d)),e.jsx(z,{opened:m,onClose:r,title:"Konfirmasi hapus",children:e.jsxs("div",{className:"px-1",children:[e.jsxs("div",{className:" text-center px-2",children:[e.jsx(p,{size:"sm",fw:500,children:"Apakah anda yakin ingin menghapus tugas dengan kode"}),e.jsxs(p,{size:"md",c:"red",fw:700,children:['"',t==null?void 0:t.task_code," || ",t==null?void 0:t.task_name,'"']})]}),e.jsxs("div",{className:"flex justify-betwen gap-2 mt-2 mb-2",children:[e.jsx(g,{color:"grey",size:"sm",fullWidth:!0,onClick:r,children:"Kembali"}),e.jsx(g,{color:"yellow",size:"sm",fullWidth:!0,onClick:()=>{s(t==null?void 0:t.id)},children:"Ya! Hapus tugas"})]})]})})]})},be=({taskEmployee:i,setSelectedDay:u,RefetchTaskEmployee:m})=>{const[o,{open:r,close:t}]=T(!1),[l,n]=c.useState(),[s,a]=c.useState(N(new Date,"EEEE",{locale:S}));c.useEffect(()=>{s&&u(s)},[s]);const d=h=>h.reduce((f,b)=>{const y=b.employee.name;return f[y]||(f[y]=[]),f[y].push(b),f},{}),x=oe(),k=async h=>{x.mutateAsync(h,{onSuccess:f=>{console.log("Success Delete:",f),m(),E({message:"Tugas pegawai berhasil dihapus",color:"green",position:"top-center"}),t()}})};return e.jsxs("section",{className:"bg-white mx-auto max-w-sm w-full shadow-lg rounded-xl z-50 relative p-4",children:[e.jsxs("div",{className:"grid grid-cols-12 text-xs items-center mb-2",children:[e.jsx("div",{className:"col-span-8",children:e.jsxs("span",{className:"text-base font-bold text-brown",children:["Tugas Hari ",s]})}),e.jsx("div",{className:"col-span-4",children:e.jsx(I,{withAsterisk:!0,allowDeselect:!1,data:[{value:"Senin",label:"Senin"},{value:"Selasa",label:"Selasa"},{value:"Rabu",label:"Rabu"},{value:"Kamis",label:"Kamis"},{value:"Jumat",label:"Jumat"},{value:"Sabtu",label:"Sabtu"},{value:"Minggu",label:"Minggu"}],value:s,onChange:h=>a(h)})})]}),e.jsx(v,{size:"xs",className:"mb-2"}),i.length!=0&&Object.entries(d(i)).map(([h,f])=>e.jsxs("div",{children:[e.jsx("div",{className:"my-2",children:e.jsx(v,{label:h,labelPosition:"left"})}),f.map((b,y)=>e.jsxs("div",{children:[e.jsxs("div",{className:"grid grid-cols-12 px-1",children:[e.jsx("div",{className:"col-span-1 m-auto",children:e.jsx(p,{fw:700,size:"sm",children:b.task.task_code})}),e.jsx("div",{className:"col-span-1 ml-1",children:e.jsx("div",{className:"w-px h-full bg-gray-300 mx-4"})}),e.jsx("div",{className:"col-span-9 ml-1 my-auto",children:e.jsx(p,{size:"12px",lineClamp:2,children:b.task.task_name})}),e.jsx("div",{className:"col-span-1",children:e.jsx(g,{color:"red",size:"compact-sm",onClick:()=>{r(),n(b)},children:e.jsx(q,{size:18})})})]}),e.jsx("div",{className:"mt-2 mb-2",children:e.jsx(v,{})})]},y))]},h)),e.jsx(z,{opened:o,onClose:t,title:"Konfirmasi hapus",children:e.jsxs("div",{className:"px-1",children:[e.jsxs("div",{className:" text-center px-2",children:[e.jsx(p,{size:"sm",fw:500,children:"Apakah anda yakin ingin menghapus tugas dengan kode"}),e.jsxs(p,{size:"sm",c:"red",fw:700,children:['"',l==null?void 0:l.day," ||"," ",l==null?void 0:l.employee.name," ||"," ",l==null?void 0:l.task.task_name,'"']})]}),e.jsxs("div",{className:"flex justify-betwen gap-2 mt-2 mb-2",children:[e.jsx(g,{color:"grey",size:"sm",fullWidth:!0,onClick:t,children:"Kembali"}),e.jsx(g,{color:"yellow",size:"sm",fullWidth:!0,onClick:()=>{k(l==null?void 0:l.id)},children:"Ya! Hapus tugas"})]})]})})]})},ke="https://dianlucky.my.id/api";async function Ne(i){return console.log("Date :",i),(await ee.get(`${ke}/daily-task-employees/by-date-all?date=${i}`,{headers:{Authorization:`Bearer ${se.getToken()}`}})).data.data}const we=i=>X({queryKey:["getDailyTaskEmployee",i],queryFn:()=>Ne(i)}),Ge=()=>{const i=A(),m=(()=>{const a=ie(new Date,"Asia/Makassar");if(a.getHours()<3){const x=ne(a);return N(x,"yyyy-MM-dd")}return N(a,"yyyy-MM-dd")})(),[o,r]=c.useState(new Date(m)),[t,l]=c.useState([]),{data:n,isLoading:s}=we(N(new Date(o||m),"yyyy-MM-dd"));return c.useEffect(()=>{n&&l(n)},[n]),console.log("Data :",t),e.jsxs("main",{children:[e.jsx("section",{className:"w-full h-20 bg-brown rounded-b-3xl"}),e.jsx("section",{className:"bg-white mx-5 p-3 shadow-md rounded-lg flex flex-col gap-2 -mt-10",children:e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{children:e.jsx(K,{onClick:()=>{i(-1)},size:21,className:"font-bold rounded-md"})}),e.jsx("div",{className:"font-semibold text-brown",children:e.jsx("h2",{className:"font-semibold",children:"Tugas Pegawai"})}),e.jsx("div",{})]})}),e.jsx("section",{className:"mt-2 px-6",children:e.jsx(fe,{})}),e.jsx("section",{className:"mt-4 px-5 mb-20",children:e.jsx(ye,{dailyTask:t,selectedDate:o,setSelectedDate:r,formattedDate:m,LoadingDailyTaskEmployee:s})})]})},Oe=()=>{const i=A(),[u,{open:m,close:o}]=T(!1),[r,t]=c.useState([]),{data:l,refetch:n}=H();c.useEffect(()=>{l&&t(l)},[l]),console.log(r);const s=W({validateInputOnChange:!0,initialValues:{task_code:"",task_name:""},validate:{task_name:x=>x.length<10?"Minimal 10 karakter":null,task_code:x=>x.length<2?"Minimal 2 karakter":x.length>4?"Kode Tugas tidak boleh lebih dari 4 karakter":null}}),a=re(),d=async x=>{if(x.preventDefault(),!s.isValid())return;const k={id:null,task_code:s.values.task_code,task_name:s.values.task_name};await a.mutateAsync(k,{onSuccess:h=>{console.log("Success:",h),s.reset(),n(),E({message:"Tugas harian berhasil ditambahkan",color:"green",position:"top-center"}),o()}})};return e.jsxs("main",{children:[e.jsx("section",{className:"w-full h-20 bg-brown rounded-b-3xl"}),e.jsx("section",{className:"bg-white mx-5 p-3 shadow-md rounded-lg flex flex-col gap-2 -mt-10",children:e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{children:e.jsx(K,{onClick:()=>{i(-1)},size:21,className:"font-bold rounded-md"})}),e.jsx("div",{className:"font-semibold text-brown",children:e.jsx("h2",{className:"font-semibold",children:"Data Tugas Harian"})}),e.jsx("div",{children:e.jsx("div",{className:"mr-2",children:e.jsx(L,{onClick:m,children:e.jsx(F,{size:22})})})})]})}),e.jsx("section",{className:"mt-2 px-7",children:e.jsx(ve,{dailyTask:r,refetchDailyTask:n})}),e.jsx(z,{opened:u,onClose:o,title:"Tambah tugas harian",children:e.jsx("div",{className:"px-3",children:e.jsxs("form",{onSubmit:d,children:[e.jsx("div",{className:"mt-2",children:e.jsx(xe,{label:"Kode Tugas",size:"sm",...s.getInputProps("task_code")},s.key("task_code"))}),e.jsx("div",{className:"mt-2",children:e.jsx(he,{label:"Nama Tugas",placeholder:"Masukkan nama tugas",size:"sm",...s.getInputProps("task_name")},s.key("task_name"))}),e.jsxs("div",{className:"flex justify-between gap-2 mt-4 mb-5",children:[e.jsx(g,{size:"sm",onClick:o,fullWidth:!0,color:"gray",children:"Kembali"}),e.jsx(g,{type:"submit",fullWidth:!0,children:"Simpan"})]})]})})})]})},Ue=()=>{const i=A(),[u,{open:m,close:o}]=T(!1);console.log("Hari :",N(new Date,"EEEE",{locale:S}));const[r,t]=c.useState(N(new Date,"EEEE",{locale:S})),[l,n]=c.useState([]),{data:s,refetch:a}=de(r);c.useEffect(()=>{s&&n(s)},[s]),c.useEffect(()=>{r&&a()},[r,a]);const[d,x]=c.useState([]),{data:k}=pe();c.useEffect(()=>{k&&x(k)},[k]);const h=d.filter(j=>j.account&&j.account.level==="Pegawai").map(j=>({value:j.id.toString(),label:j.name})),[f,b]=c.useState([]),{data:y}=H();c.useEffect(()=>{y&&b(y)},[y]);const G=f.map(j=>({value:j.id.toString(),label:`${j.task_code} | ${j.task_name}`})),[C,B]=c.useState([]),D=W({validateInputOnChange:!0,initialValues:{day:"",employee_id:""}}),O=me(),U=async j=>{if(j.preventDefault(),C.length===0){console.error("Tidak ada kode tugas yang dipilih.");return}const J=D.values.day,V=parseInt(D.values.employee_id);try{const M=C.map(Y=>{const Q=parseInt(Y),Z={day:J,employee_id:V,task_id:Q};return O.mutateAsync(Z)});await Promise.all(M),console.log("Semua data berhasil dikirim!"),D.reset(),B([]),a(),E({message:"Tugas pegawai berhasil ditambahkan",color:"green",position:"top-center"}),o()}catch(M){console.error("Gagal mengirim data:",M)}};return e.jsxs("main",{children:[e.jsx("section",{className:"w-full h-20 bg-brown rounded-b-3xl"}),e.jsx("section",{className:"bg-white mx-5 p-3 shadow-md rounded-lg flex flex-col gap-2 -mt-10",children:e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{children:e.jsx(K,{onClick:()=>{i(-1)},size:21,className:"font-bold rounded-md"})}),e.jsx("div",{className:"font-semibold text-brown",children:e.jsx("h2",{className:"font-semibold",children:"Data Tugas Pegawai"})}),e.jsx("div",{children:e.jsx("div",{className:"mr-2",children:e.jsx(L,{onClick:m,children:e.jsx(F,{size:22})})})})]})}),e.jsx("section",{className:"mt-2 px-5 mb-20",children:e.jsx(be,{taskEmployee:l,setSelectedDay:t,RefetchTaskEmployee:a})}),e.jsx(z,{opened:u,onClose:o,title:"Tambah tugas pegawai",children:e.jsxs("form",{onSubmit:U,className:"-mt-1",children:[e.jsx(I,{label:"Hari",size:"sm",withAsterisk:!0,data:[{label:"Senin",value:"Senin"},{label:"Selasa",value:"Selasa"},{label:"Rabu",value:"Rabu"},{label:"Kamis",value:"Kamis"},{label:"Jumat",value:"Jumat"},{label:"Sabtu",value:"Sabtu"},{label:"Minggu",value:"Minggu"}],...D.getInputProps("day")}),e.jsx(I,{withAsterisk:!0,label:"Pegawai",placeholder:"Pegawai",data:h,...D.getInputProps("employee_id")}),e.jsx(ue,{withAsterisk:!0,label:"Kode tugas",placeholder:"Kode tugas",data:G,value:C,onChange:B}),e.jsxs("div",{className:"flex justify-between gap-2 mt-4 mb-5",children:[e.jsx(g,{color:"grey",fullWidth:!0,onClick:o,children:"Kembali"}),e.jsx(g,{type:"submit",fullWidth:!0,children:"Simpan"})]})]})})]})};export{Oe as DailyTaskDataPage,ve as DailyTaskDataSection,fe as DailyTaskMenu,Ge as DailyTaskPageOwner,be as TaskEmployeeDataSection,Ue as TaskEmployeePage,ye as TodayTaskSection};
