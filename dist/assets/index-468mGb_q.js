import{e as S,s as T,d as M,r as v,l as U,z as I,j as e,D as E,T as j,b7 as f,B as m,b8 as L,a5 as K,$ as b,b as P,U as W}from"./index-WTq-jBmO.js";import{u as A}from"./use-form-BhJjUM-b.js";import{I as R}from"./IconCategory-RUHqXNgq.js";import{I as V}from"./IconPencil-Ptg6tcdQ.js";import{I as G}from"./IconTrash-CZwS3Ktf.js";import{T as $}from"./TextInput-BhsxxCwZ.js";import{T as B}from"./Textarea-DD1SEny2.js";import{u as H,C as O}from"./CategorySkeleton-tVSOVsEc.js";import{g as ye}from"./CategorySkeleton-tVSOVsEc.js";import{I as q}from"./IconChevronLeft-CpJ0R4r6.js";import{I as Y}from"./IconPlus-Y1sj9bFE.js";import"./InputBase-D3mEq3x3.js";import"./Input-D56DVYoT.js";import"./Skeleton-D6fO1EK0.js";const J="https://dianlucky.my.id/api",Q=async a=>(await S.post(`${J}/categories/`,a,{headers:{Authorization:`Bearer ${T.getToken()}`}})).data,X=()=>M({mutationFn:Q,onMutate:async()=>{},onError:a=>{console.log("Error :",a)}}),Z="https://dianlucky.my.id/api",_=async a=>(await S.delete(`${Z}/categories/${a}`,{headers:{Authorization:`Bearer ${T.getToken()}`}})).data,ee=()=>M({mutationFn:a=>_(a),onError:a=>{console.log(a)}}),se="https://dianlucky.my.id/api";async function ae(a,n){return(await S.patch(`${se}/categories/${a}`,n,{headers:{Authorization:`Bearer ${T.getToken()}`}})).data}const te=a=>M({mutationFn:n=>ae(a,n)}),ne=({categories:a,RefetchCategories:n})=>{const[s,c]=v.useState(),{pathname:N}=U(),[k,{open:u,close:r}]=I(!1),[w,{open:o,close:h}]=I(!1),C=ee(),l=async t=>{C.mutateAsync(t,{onSuccess:d=>{console.log("Sukses :",d),c(void 0),n(),b({message:"Kategori berhasil dihapus",color:"green",position:"top-center"}),r()},onError:d=>{var y,g;const x=d,p=((g=(y=x==null?void 0:x.response)==null?void 0:y.data)==null?void 0:g.errors)||"Gagal menghapus kategori. Silakan coba lagi.";r(),b({message:p,color:"red",position:"top-center"})}})},i=A({validateInputOnChange:!0,initialValues:{code:s?s.code:"",name:s?s.name:""},validate:{name:t=>t.length<5?"Minimal 5 Karakter":null,code:t=>t.length<2?"Minimal 2 karakter":t.length>4?"Kode Tugas tidak boleh lebih dari 4 karakter":null}}),z=te(s==null?void 0:s.id),F=async t=>{if(t.preventDefault(),!i.isValid())return;const d={code:i.values.code,name:i.values.name};await z.mutateAsync(d,{onSuccess:()=>{n(),h(),b({message:"Kategori berhasil diubah",color:"green",position:"top-center"})},onError:x=>{var g,D;const p=x,y=((D=(g=p==null?void 0:p.response)==null?void 0:g.data)==null?void 0:D.errors)||"Gagal mengubah kategori. Silakan coba lagi.";h(),b({message:y,color:"red",position:"top-center"})}})};return v.useEffect(()=>{s&&i.setValues({code:s.code,name:s.name})},[s]),e.jsxs(e.Fragment,{children:[e.jsxs("section",{className:"bg-white mx-auto max-w-sm w-full shadow-lg rounded-md relative p-4",children:[e.jsxs("div",{className:"flex justify-between text-xs items-center mb-2",children:[e.jsx("span",{className:"text-sm font-bold text-brown",children:"Daftar Kategori"}),e.jsx(R,{size:20})]}),e.jsx(E,{size:"xs",className:"mb-2"}),a.length!=0&&a.filter(t=>N.includes("frozen")?t.name=="Frozen":t.name!="Frozen").map((t,d)=>e.jsxs("div",{children:[e.jsxs("div",{className:"grid grid-cols-12 px-2",children:[e.jsx("div",{className:"col-span-1 m-auto",children:e.jsx(j,{fw:700,size:"md",children:t.code})}),e.jsx("div",{className:"col-span-1 ml-1",children:e.jsx("div",{className:"w-px h-full bg-gray-300 mx-4"})}),e.jsx("div",{className:"col-span-8 ml-1 my-auto",children:e.jsx(j,{size:"xs",lineClamp:2,truncate:"end",children:t.name})}),e.jsx("div",{className:"col-span-2 ml-4 flex gap-1",children:e.jsxs(f,{shadow:"xs",position:"bottom-end",width:100,withArrow:!0,children:[e.jsx(f.Target,{children:e.jsx(m,{color:"gray",disabled:t.name=="Frozen",size:"compact-xs",children:e.jsx(L,{size:18})})}),e.jsxs(f.Dropdown,{children:[e.jsx(f.Item,{onClick:()=>{o(),c(t)},leftSection:e.jsx(V,{size:14}),children:"Edit"}),e.jsx(f.Item,{leftSection:e.jsx(G,{size:14}),onClick:()=>{u(),c(t)},children:"Hapus"})]})]})})]}),e.jsx("div",{className:"mt-2 mb-2",children:e.jsx(E,{})})]},d)),a.length==0&&e.jsx("div",{className:"text-center",children:e.jsx(j,{size:"xs",fw:300,fs:"italic",children:"Kategori tidak ditemukan"})})]}),e.jsx(K,{opened:k,onClose:r,title:"Konfirmasi hapus",children:e.jsxs("div",{className:"px-1",children:[e.jsxs("div",{className:" text-center px-2",children:[e.jsx(j,{size:"sm",fw:500,children:"Apakah anda yakin ingin menghapus kategori dengan kode"}),e.jsxs(j,{size:"sm",c:"red",fw:700,children:['"',s==null?void 0:s.code," || ",s==null?void 0:s.name,'"']})]}),e.jsxs("div",{className:"flex justify-betwen gap-2 mt-2 mb-2",children:[e.jsx(m,{color:"grey",size:"xs",fullWidth:!0,onClick:r,children:"Kembali"}),e.jsx(m,{color:"yellow",size:"xs",fullWidth:!0,onClick:()=>{l(s==null?void 0:s.id)},children:"Ya! Hapus kategori"})]})]})}),e.jsx(K,{opened:w,onClose:h,title:"Edit kategori",children:e.jsx("div",{className:"px-2 -mt-2",children:e.jsxs("form",{onSubmit:F,children:[e.jsx("div",{className:"mt-2",children:e.jsx($,{label:"Kode Kategori",size:"sm",...i.getInputProps("code")},i.key("code"))}),e.jsx("div",{className:"mt-2",children:e.jsx(B,{label:"Nama Kategori",placeholder:"Masukkan nama kategori",size:"sm",...i.getInputProps("name")},i.key("name"))}),e.jsxs("div",{className:"flex justify-between gap-2 mt-4 mb-5",children:[e.jsx(m,{size:"sm",onClick:r,fullWidth:!0,color:"gray",children:"Kembali"}),e.jsx(m,{type:"submit",fullWidth:!0,children:"Simpan"})]})]})})})]})},fe=()=>{const a=P(),[n,{open:s,close:c}]=I(!1),[N,k]=v.useState([]),{data:u,refetch:r,isLoading:w}=H();v.useEffect(()=>{k(u||[])},[u]);const o=A({validateInputOnChange:!0,initialValues:{code:"",name:""},validate:{name:l=>l.length<5?"Minimal 5 Karakter":null,code:l=>l.length<2?"Minimal 2 karakter":l.length>4?"Kode Tugas tidak boleh lebih dari 4 karakter":null}}),h=X(),C=async l=>{if(l.preventDefault(),!o.isValid())return;const i={code:o.values.code,name:o.values.name};await h.mutateAsync(i,{onSuccess:z=>{console.log("Success:",z),o.reset(),r(),b({message:"Berhasil menambahkan kategori baru",color:"green",position:"top-center"}),c()}})};return e.jsxs(e.Fragment,{children:[e.jsx("section",{className:"w-full h-20 bg-brown rounded-b-3xl"}),e.jsx("section",{className:"bg-white mx-5 p-3 shadow-md rounded-lg flex flex-col gap-2 -mt-10",children:e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{children:e.jsx(q,{onClick:()=>{a(-1)},size:21,className:"font-bold rounded-md"})}),e.jsx("div",{className:"font-semibold text-brown",children:e.jsx("h2",{className:"font-semibold",children:"Kelola Kategori"})}),e.jsx("div",{children:e.jsx("div",{className:"mr-2",children:e.jsx(W,{onClick:s,children:e.jsx(Y,{size:22})})})})]})}),e.jsx("section",{children:e.jsx("div",{className:"mt-2 px-7",children:w?e.jsx(O,{}):e.jsx(ne,{categories:N,RefetchCategories:r})})}),e.jsx(K,{opened:n,onClose:c,title:"Tambah kategori",children:e.jsx("div",{className:"px-2 -mt-2",children:e.jsxs("form",{onSubmit:C,children:[e.jsx("div",{className:"mt-2",children:e.jsx($,{label:"Kode Kategori",size:"sm",...o.getInputProps("code")},o.key("code"))}),e.jsx("div",{className:"mt-2",children:e.jsx(B,{label:"Nama Kategori",placeholder:"Masukkan nama kategori",size:"sm",...o.getInputProps("name")},o.key("name"))}),e.jsxs("div",{className:"flex justify-between gap-2 mt-4 mb-5",children:[e.jsx(m,{size:"sm",onClick:c,fullWidth:!0,color:"gray",children:"Kembali"}),e.jsx(m,{type:"submit",fullWidth:!0,children:"Simpan"})]})]})})})]})};export{ne as CategoryData,fe as CategoryPage,O as CategorySkeleton,ye as getAllCategory,Q as postCategory,X as useCreateCategory,ee as useDeleteCategory,H as useGetAllCategory,te as useUpdateCategory};
