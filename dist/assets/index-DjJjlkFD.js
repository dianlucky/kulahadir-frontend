import{g as P,r as c,j as e,T as s,D as g,c as u,i as x,z as E,I as B,B as w,a5 as W,m as C,N as V}from"./index-WTq-jBmO.js";import{R as X}from"./RingProgress-w2LYa-sJ.js";import{B as S}from"./Badge-BM-of4hJ.js";import{u as I}from"./getSchedule-BVc8bSdL.js";import{g as We,d as Pe,e as Ie,f as Le,c as Fe,b as Ke,a as Re}from"./getSchedule-BVc8bSdL.js";import{f as Z}from"./getAttendance-jmiWOIPT.js";import{T as m}from"./Table-C8ODqdXw.js";import{I as L}from"./IconUsers-v6HwPn2X.js";import{I as F}from"./IconCalendar-a5o3o5ow.js";import{D as K}from"./DatePicker-KQw2JWcj.js";import{u as ee,a as se}from"./createDailyTaskEmployee-BfI0GAcD.js";import{b as Ge,c as He}from"./createDailyTaskEmployee-BfI0GAcD.js";import{a as ae}from"./updateSchedule-DMmCu442.js";import{u as Ye}from"./updateSchedule-DMmCu442.js";import{T as te}from"./Tooltip-Bbki2meS.js";import{I as le}from"./IconPencil-Ptg6tcdQ.js";import{S as ne}from"./Select-DftvBaKi.js";import"./use-dates-state-D9bGxs59.js";import"./get-style-object-DUJZA7T_.js";import"./Input-D56DVYoT.js";import"./CheckIcon-DsLgxQ_k.js";import"./InputBase-D3mEq3x3.js";/**
 * @license @tabler/icons-react v3.34.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var ie=P("outline","calendar-time","IconCalendarTime",[["path",{d:"M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4",key:"svg-0"}],["path",{d:"M18 18m-4 0a4 4 0 1 0 8 0a4 4 0 1 0 -8 0",key:"svg-1"}],["path",{d:"M15 3v4",key:"svg-2"}],["path",{d:"M7 3v4",key:"svg-3"}],["path",{d:"M3 11h16",key:"svg-4"}],["path",{d:"M18 16.496v1.504l1 1",key:"svg-5"}]]);/**
 * @license @tabler/icons-react v3.34.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var ce=P("outline","chart-bar","IconChartBar",[["path",{d:"M3 13a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v6a1 1 0 0 1 -1 1h-4a1 1 0 0 1 -1 -1z",key:"svg-0"}],["path",{d:"M15 9a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v10a1 1 0 0 1 -1 1h-4a1 1 0 0 1 -1 -1z",key:"svg-1"}],["path",{d:"M9 5a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v14a1 1 0 0 1 -1 1h-4a1 1 0 0 1 -1 -1z",key:"svg-2"}],["path",{d:"M4 20h14",key:"svg-3"}]]);const de=({date:d,schedules:n})=>{const[j,h]=c.useState(0),[t,l]=c.useState(0),[i,k]=c.useState(0);return c.useEffect(()=>{const a=n?n.filter(o=>status=="Semua"?!0:o.employee.account.status==status).length:0,b=n?n.filter(o=>(o.attendance_status==="Working"||o.attendance_status==="Present")&&status==="Semua"?!0:o.employee.account.status==status).length:0,D=n?n.filter(o=>o.attendance_status==="Late"&&status==="Semua"?!0:o.employee.account.status==status).length:0,z=n?n.filter(o=>o.attendance_status==="belum hadir"&&status==="Semua"?!0:o.employee.account.status==status).length:0;h(b*100/a),l(D*100/a),k(z*100/a)},[n]),e.jsxs("section",{className:"bg-white rounded-sm shadow-sm p-4",children:[e.jsxs("div",{className:"flex justify-between mb-1 -mt-3 mb-3",children:[e.jsx(s,{fw:700,size:"md",c:"#343a40",children:"Rekap kehadiran"}),e.jsx(ce,{})]}),e.jsx(g,{}),e.jsxs("div",{children:[e.jsxs("div",{className:"mt-2 flex mb-2",children:[e.jsx(s,{fw:400,size:"sm",children:"Tanggal :"}),e.jsx(s,{fw:700,size:"sm",ml:2,children:d&&u(d,"EEEE, dd MMMM yyyy",{locale:x})})]}),e.jsx(g,{}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(X,{size:120,thickness:16,label:e.jsxs(s,{fw:700,size:"16px",ta:"center",children:[n.filter(a=>a.attendance_status=="Working"||a.attendance_status=="Present"||a.attendance_status=="Late").length,"/",n.length]}),sections:[{value:j,color:"#8FD14F"},{value:i,color:"grey"},{value:t,color:"yellow"}]}),e.jsx("div",{children:e.jsxs("div",{className:"mt-6 ml-3",children:[e.jsxs("div",{className:"flex",children:[e.jsx(S,{color:"#8FD14F",size:"md",children:n.filter(a=>a.attendance_status=="Present"||a.attendance_status=="Working").length}),e.jsx(s,{fw:"bold",size:"xs",ml:3,children:"Hadir"})]}),e.jsxs("div",{className:"flex mt-2",children:[e.jsx(S,{color:"yellow",size:"md",children:n.filter(a=>a.attendance_status=="Late").length}),e.jsx(s,{fw:"bold",size:"xs",ml:3,children:"Terlambat"})]}),e.jsxs("div",{className:"flex mt-2",children:[e.jsx(S,{color:"grey",size:"md",children:n.filter(a=>a.attendance_status=="belum hadir").length}),e.jsx(s,{fw:"bold",size:"xs",ml:3,children:"Belum hadir"})]})]})})]})]})]})},re=({schedules:d,attendances:n})=>{const j=d.map(t=>{const l=n.find(i=>i.schedule_id===t.id);return{...t,is_checkin:l?l.check_in:null,attendance_id:(l==null?void 0:l.id)??null,attendance_status:(l==null?void 0:l.status)??null,attendance:l||null}}),h=j.map((t,l)=>e.jsxs(m.Tr,{children:[e.jsx(m.Td,{children:t.employee.name}),e.jsx(m.Td,{children:t.attendance!=null?u(t.attendance.check_in,"HH:mm",{locale:x}):"--:--"}),e.jsxs(m.Td,{children:[" ",t.attendance!=null&&t.attendance.check_out?u(t.attendance.check_out,"HH:mm",{locale:x}):"--:--"]}),e.jsx(m.Td,{children:e.jsx(S,{radius:"xs",size:"sm",color:t.attendance_status=="belum hadir"?"red":t.attendance_status=="Working"?"grey":t.attendance_status=="Done"?"green":"yellow",children:t.attendance_status})})]},l));return console.log("worker: ",j),e.jsxs("section",{className:"bg-white rounded-sm shadow-sm p-4",children:[e.jsxs("div",{className:"flex justify-between mb-1 -mt-3 mb-3",children:[e.jsx(s,{fw:700,size:"md",c:"#343a40",children:"Daftar pegawai"}),e.jsx(L,{})]}),e.jsx("div",{children:e.jsxs(m,{striped:!0,highlightOnHover:!0,withTableBorder:!0,withColumnBorders:!0,className:"text-dark font-bold cursor-pointer text-sm",children:[e.jsx(m.Thead,{children:e.jsxs(m.Tr,{children:[e.jsx(m.Th,{className:"font-bold",children:"Nama pegawai"}),e.jsx(m.Th,{className:"font-bold",children:"Check-in"}),e.jsx(m.Th,{className:"font-bold",children:"Check-out"}),e.jsx(m.Th,{className:"font-bold",children:"Status"})]})}),e.jsx(m.Tbody,{children:h})]})})]})},oe=()=>{const[d,n]=c.useState(new Date),[j,h]=c.useState([]),{data:t,isLoading:l}=I(u(d||new Date,"yyyy-MM-dd",{locale:x}));c.useEffect(()=>{t&&h(t)},[t,d]),console.log("Jadwal : ",j);const[i,k]=c.useState([]),{data:a,isLoading:b}=Z(u(d||new Date,"yyyy-MM-dd",{locale:x}));return c.useEffect(()=>{a&&k(a)},[a,d]),console.log("Kehadiran : ",i),e.jsxs("section",{className:"bg-white shadow-lg p-6 rounded-lg mt-2",children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx(s,{fw:"bolder",size:"lg",c:"#343a40",children:"Data Kehadiran Pegawai"})}),e.jsx(g,{}),e.jsxs("div",{className:"grid grid-cols-12 mt-5 gap-2",children:[e.jsxs("div",{className:"col-span-3 bg-white shadow-sm p-6 rounded-lg h-[370px]",children:[e.jsxs("div",{className:"flex justify-between mb-1 -mt-3",children:[e.jsx(s,{fw:"bold",size:"md",c:"#343a40",children:"Kalender"}),e.jsx(F,{})]}),e.jsx(g,{}),e.jsx("div",{className:"flex justify-center w-full mt-2",children:e.jsx(K,{value:d,onChange:n,size:"sm"})})]}),e.jsx("div",{className:"col-span-3",children:e.jsx(de,{schedules:j,date:d})}),!b&&!l&&e.jsx("div",{className:"col-span-6",children:e.jsx(re,{schedules:j,attendances:i})})]})]})},me="https://dianlucky.my.id/api",he="/images/profile-default.png",_e=()=>{const[d,{toggle:n}]=E(),[j,h]=c.useState(!1),[t,l]=c.useState(""),[i,k]=c.useState(),[a,b]=c.useState(i==null?void 0:i.status),[D,{open:z,close:o}]=E(!1),[R,{open:U,close:_}]=E(!1),[v,G]=c.useState(new Date),[f,H]=c.useState();c.useEffect(()=>{if(v){let r=u(v??new Date,"yyyy-MM-dd",{locale:x});H(r)}},[v]);const[N,J]=c.useState([]),{data:M,refetch:T}=I(f);c.useEffect(()=>{b(i==null?void 0:i.status),M&&J(M)},[M,i]);const Y=ee(),$=se(),O=async()=>{const r={month:u(new Date(f||""),"MM-yyyy",{locale:x}),make_schedule:!0};await Y.mutateAsync(r,{onSuccess:p=>{console.log("Success:",p),h(!0),l("Jadwal berhasil dibuat"),T(),o(),close(),setTimeout(()=>{h(!1)},4500)}});const y={month:u(new Date(f||""),"yyyy-MM",{locale:x}),make_task:!0};await $.mutateAsync(y,{onSuccess:p=>{console.log("Success:",p),h(!0),l("Jadwal berhasil dibuat"),T(),o(),close(),setTimeout(()=>{h(!1)},4500)}})},q=ae(i==null?void 0:i.id),Q=async()=>{const r={status:a};let y="";a=="on"?y="Pegawai berhasil di-aktifkan dari jadwal":y="Pegawai berhasil di-nonaktifkan dari jadwal",await q.mutateAsync(r,{onSuccess:p=>{console.log("Success:",p),h(!0),l(y),T(),_(),close(),setTimeout(()=>{h(!1)},4500)}})};return e.jsxs(e.Fragment,{children:[e.jsxs("section",{className:"bg-white shadow-lg p-6 rounded-lg",children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx(s,{fw:"bolder",size:"lg",c:"#343a40",children:"Data Jadwal Pegawai"})}),e.jsx(g,{}),e.jsxs("div",{className:"grid grid-cols-12 mt-5 gap-2",children:[e.jsxs("div",{className:"col-span-3 bg-white shadow-sm p-6 rounded-lg h-[370px]",children:[e.jsxs("div",{className:"flex justify-between mb-1 -mt-3",children:[e.jsx(s,{fw:"bold",size:"md",c:"#343a40",children:"Kalender"}),e.jsx(F,{})]}),e.jsx(g,{}),e.jsx("div",{className:"flex justify-center w-full mt-2",children:e.jsx(K,{value:v,onChange:G,size:"sm"})})]}),e.jsxs("div",{className:"col-span-3 bg-white shadow-sm p-6 rounded-lg",children:[e.jsxs("div",{className:"flex justify-between mb-1 -mt-3",children:[e.jsx(s,{fw:"bold",size:"md",c:"#343a40",children:"Detail jadwal"}),e.jsx(ie,{})]}),e.jsx(g,{}),e.jsxs("div",{className:"w-full mt-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx(s,{size:"sm",children:"Tanggal :"}),e.jsxs(s,{fw:"bold",size:"sm",c:"#343a40",children:[" ",v?u(new Date(v),"EEEE, dd MMMM yyyy",{locale:x}):""]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(s,{size:"sm",children:"Pegawai :"}),e.jsx(s,{fw:"bold",size:"sm",c:"#343a40",children:N?N.filter(r=>r.status==="on").length:" - "})]}),e.jsx(g,{className:"mt-2"}),N.length==0&&e.jsx("div",{className:"flex justify-center",children:e.jsxs("div",{className:"text-center mt-10",children:[e.jsx("div",{children:e.jsx(B,{className:"ml-15",src:"/images/not-found.svg",style:{width:"120px"}})}),e.jsx("div",{children:e.jsx(s,{fw:"bold",c:"#343a40",children:"Jadwal tidak ditemukan"})}),e.jsx("div",{className:"mt-2",children:e.jsx(w,{color:"yellow",onClick:z,children:"Buat jadwal untuk bulan ini"})})]})}),N==null&&e.jsx("div",{className:"mt-2",children:e.jsx(w,{fullWidth:!0,size:"sm",c:"white",children:"Tambah pegawai"})})]})]}),e.jsxs(W,{opened:D,onClose:o,title:"Konfirmasi pembuatan jadwal",children:[e.jsxs("div",{className:"text-center px-2",children:[e.jsx("div",{children:e.jsx(s,{fw:"bold",size:"md",children:"Apakah anda yakin ingin membuat jadwal untuk bulan"})}),e.jsx("div",{className:"mt-2",children:e.jsxs(s,{fw:"bold",color:"red",children:['"',f&&u(new Date(f),"MMMM yyyy",{locale:x}),'"']})})]}),e.jsxs("div",{className:"flex mt-5 gap-2 px-1",children:[e.jsx(w,{color:"grey",c:"white",onClick:close,fullWidth:!0,children:"Kembali"}),e.jsx(w,{loading:d,fullWidth:!0,onClick:()=>{O()},children:"Ya! Buat jadwal!"})]})]}),e.jsxs("div",{className:"relative col-span-6 bg-white shadow-sm p-6 rounded-lg",children:[e.jsxs("div",{className:"flex justify-between mb-1 -mt-3",children:[e.jsx(s,{fw:"bold",size:"md",c:"#343a40",children:"Data pegawai yang bekerja"}),e.jsx(L,{})]}),e.jsx(g,{}),e.jsx("div",{className:"grid grid-cols-2 w-full gap-4 mt-2",children:N.length!=0&&N.map((r,y)=>{var p,A;return e.jsx("div",{className:"w-full",children:e.jsx(C,{color:r.status=="on"?"green":"red",inline:!0,size:12,position:"top-start",offset:8,children:e.jsx("div",{className:"bg-white shadow-sm hover:shadow-md p-4 rounded-xl max-w-full border border-gray-200 transition-all duration-200",children:e.jsxs("div",{className:"max-w-md grid grid-cols-12 ",children:[e.jsx("div",{className:"col-span-2",children:e.jsx("div",{className:"w-10 h-10 rounded-full overflow-hidden border-2 border-gray-100",children:e.jsx(B,{src:(p=r.employee)!=null&&p.profile_pic?`${me}/uploads/employees/${(A=r.employee)==null?void 0:A.profile_pic}`:he,alt:"Foto Profil",className:"w-full h-full object-cover"})})}),e.jsxs("div",{className:"col-span-8",children:[e.jsx(s,{fw:600,size:"sm",className:"text-gray-900 truncate leading-tight",children:r.employee.name}),e.jsx(s,{size:"xs",className:"text-gray-500 mt-1",children:r.employee.account.status})]}),e.jsx("div",{className:"col-span-2",children:e.jsx(te,{label:"Ubah jadwal",withArrow:!0,transitionProps:{transition:"fade-up",duration:300},children:e.jsx(w,{size:"sm",color:"yellow",variant:"filled",className:"min-w-[40px] h-10",onClick:()=>{U(),k(r)},children:e.jsx(le,{size:18})})})})]})})})},y)})}),e.jsxs(W,{opened:R,onClose:_,title:"Konfirmasi hapus pekerja dari jadwal",children:[e.jsxs("div",{className:"text-center px-2",children:[e.jsx("div",{children:e.jsx(s,{fw:"bold",size:"md",children:"Apakah anda yakin ingin mengubah status pekerja dari jadwal?"})}),e.jsx("div",{className:"mt-2",children:e.jsxs(s,{fw:"bold",color:"red",children:['"',f&&u(new Date(f),"EEEE, dd MMMM yyyy",{locale:x})," ","| ",i&&i.employee.name,'"']})}),e.jsx("div",{className:"text-left",children:e.jsx(ne,{label:"Status",data:["on","off"],value:a,onChange:r=>b(r)})})]}),e.jsxs("div",{className:"flex mt-5 gap-2 px-1",children:[e.jsx(w,{color:"grey",c:"white",onClick:close,fullWidth:!0,children:"Kembali"}),e.jsx(w,{loading:d,fullWidth:!0,onClick:()=>{Q()},children:"Ya! Ubah status"})]})]}),e.jsxs("div",{className:"absolute bottom-2 right-3 flex items-center space-x-1",children:[e.jsx("div",{children:e.jsx(C,{size:12,color:"red",offset:1})}),e.jsx("div",{className:"ml-1",children:e.jsx(s,{size:"xs",children:"Tidak bekerja"})})]}),e.jsxs("div",{className:"absolute bottom-2 right-30 flex items-center space-x-1",children:[e.jsx("div",{children:e.jsx(C,{size:12,color:"green",offset:1})}),e.jsx("div",{className:"ml-1",children:e.jsx(s,{size:"xs",children:"Bekerja"})})]})]})]}),e.jsx("div",{className:"fixed bottom-4 right-4 z-50 w-100",children:j&&e.jsx(V,{color:"teal",title:"Berhasil!",mt:"md",children:t})})]}),e.jsx(oe,{})]})};export{re as AttendanceTable,de as RecapAttendance,_e as SchedulePageAdmin,oe as WorkerDetailSchedule,Ge as createDailyTaskEmployee,He as createSchedule,We as getAllSchedule,Pe as getScheduleByDate,Ie as getScheduleByDateStatus,Le as getScheduleByMonthAll,se as useCreateDailyTaskEmployee,ee as useCreateSchedule,Fe as useGetAllSchedule,I as useGetScheduleByDate,Ke as useGetScheduleByDateStatus,Re as useGetScheduleByMonthAll,ae as useUpdateSchedule,Ye as useUpdateScheduleByDateEmployeeId};
