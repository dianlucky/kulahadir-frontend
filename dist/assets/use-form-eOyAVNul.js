import{r as l,b2 as ge}from"./index-BOpnoju3.js";function Se(t){if(!/^[0-9a-zA-Z-]+$/.test(t))throw new Error(`[@mantine/use-form] Form name "${t}" is invalid, it should contain only letters, numbers and dashes`)}const pe=typeof window<"u"?l.useLayoutEffect:l.useEffect;function k(t,e){pe(()=>{if(t)return window.addEventListener(t,e),()=>window.removeEventListener(t,e)},[t])}function Fe(t,e){t&&Se(t),k(`mantine-form:${t}:set-field-value`,r=>e.setFieldValue(r.detail.path,r.detail.value)),k(`mantine-form:${t}:set-values`,r=>e.setValues(r.detail)),k(`mantine-form:${t}:set-initial-values`,r=>e.setInitialValues(r.detail)),k(`mantine-form:${t}:set-errors`,r=>e.setErrors(r.detail)),k(`mantine-form:${t}:set-field-error`,r=>e.setFieldError(r.detail.path,r.detail.error)),k(`mantine-form:${t}:clear-field-error`,r=>e.clearFieldError(r.detail)),k(`mantine-form:${t}:clear-errors`,e.clearErrors),k(`mantine-form:${t}:reset`,e.reset),k(`mantine-form:${t}:validate`,e.validate),k(`mantine-form:${t}:validate-field`,r=>e.validateField(r.detail)),k(`mantine-form:${t}:reorder-list-item`,r=>e.reorderListItem(r.detail.path,r.detail.payload)),k(`mantine-form:${t}:remove-list-item`,r=>e.removeListItem(r.detail.path,r.detail.index)),k(`mantine-form:${t}:insert-list-item`,r=>e.insertListItem(r.detail.path,r.detail.item,r.detail.index)),k(`mantine-form:${t}:set-dirty`,r=>e.setDirty(r.detail)),k(`mantine-form:${t}:set-touched`,r=>e.setTouched(r.detail)),k(`mantine-form:${t}:reset-dirty`,r=>e.resetDirty(r.detail)),k(`mantine-form:${t}:reset-touched`,e.resetTouched)}function me(t){return e=>{if(!e)t(e);else if(typeof e=="function")t(e);else if(typeof e=="object"&&"nativeEvent"in e){const{currentTarget:r}=e;r instanceof HTMLInputElement?r.type==="checkbox"?t(r.checked):t(r.value):(r instanceof HTMLTextAreaElement||r instanceof HTMLSelectElement)&&t(r.value)}else t(e)}}function X(t){return t===null||typeof t!="object"?{}:Object.keys(t).reduce((e,r)=>{const n=t[r];return n!=null&&n!==!1&&(e[r]=n),e},{})}function je(t){const[e,r]=l.useState(X(t)),n=l.useRef(e),s=l.useCallback(u=>{r(a=>{const E=X(typeof u=="function"?u(a):u);return n.current=E,E})},[]),o=l.useCallback(()=>s({}),[]),c=l.useCallback(u=>{n.current[u]!==void 0&&s(a=>{const E={...a};return delete E[u],E})},[e]),f=l.useCallback((u,a)=>{a==null||a===!1?c(u):n.current[u]!==a&&s(E=>({...E,[u]:a}))},[e]);return{errorsState:e,setErrors:s,clearErrors:o,setFieldError:f,clearFieldError:c}}function Z(t,e){if(e===null||typeof e!="object")return{};const r={...e};return Object.keys(e).forEach(n=>{n.includes(`${String(t)}.`)&&delete r[n]}),r}function x(t,e){const r=t.substring(e.length+1).split(".")[0];return parseInt(r,10)}function ee(t,e,r,n){if(e===void 0)return r;const s=`${String(t)}`;let o=r;n===-1&&(o=Z(`${s}.${e}`,o));const c={...o},f=new Set;return Object.entries(o).filter(([u])=>{if(!u.startsWith(`${s}.`))return!1;const a=x(u,s);return Number.isNaN(a)?!1:a>=e}).forEach(([u,a])=>{const E=x(u,s),p=u.replace(`${s}.${E}`,`${s}.${E+n}`);c[p]=a,f.add(p),f.has(u)||delete c[u]}),c}function ke(t,{from:e,to:r},n){const s=`${t}.${e}`,o=`${t}.${r}`,c={...n},f=new Set;return Object.keys(n).forEach(u=>{if(f.has(u))return;let a,E;if(u.startsWith(s)?(a=u,E=u.replace(s,o)):u.startsWith(o)&&(a=u.replace(o,s),E=u),a&&E){const p=c[a],j=c[E];j===void 0?delete c[a]:c[a]=j,p===void 0?delete c[E]:c[E]=p,f.add(a),f.add(E)}}),c}function te(t,e,r){typeof r.value=="object"&&(r.value=P(r.value)),!r.enumerable||r.get||r.set||!r.configurable||!r.writable||e==="__proto__"?Object.defineProperty(t,e,r):t[e]=r.value}function P(t){if(typeof t!="object")return t;var e=0,r,n,s,o=Object.prototype.toString.call(t);if(o==="[object Object]"?s=Object.create(t.__proto__||null):o==="[object Array]"?s=Array(t.length):o==="[object Set]"?(s=new Set,t.forEach(function(c){s.add(P(c))})):o==="[object Map]"?(s=new Map,t.forEach(function(c,f){s.set(P(f),P(c))})):o==="[object Date]"?s=new Date(+t):o==="[object RegExp]"?s=new RegExp(t.source,t.flags):o==="[object DataView]"?s=new t.constructor(P(t.buffer)):o==="[object ArrayBuffer]"?s=t.slice(0):o.slice(-6)==="Array]"&&(s=new t.constructor(t)),s){for(n=Object.getOwnPropertySymbols(t);e<n.length;e++)te(s,n[e],Object.getOwnPropertyDescriptor(t,n[e]));for(e=0,n=Object.getOwnPropertyNames(t);e<n.length;e++)Object.hasOwnProperty.call(s,r=n[e])&&s[r]===t[r]||te(s,r,Object.getOwnPropertyDescriptor(t,r))}return s||t}function ce(t){return typeof t!="string"?[]:t.split(".")}function D(t,e){const r=ce(t);if(r.length===0||typeof e!="object"||e===null)return;let n=e[r[0]];for(let s=1;s<r.length&&n!=null;s+=1)n=n[r[s]];return n}function v(t,e,r){const n=ce(t);if(n.length===0)return r;const s=P(r);if(n.length===1)return s[n[0]]=e,s;let o=s[n[0]];for(let c=1;c<n.length-1;c+=1){if(o===void 0)return s;o=o[n[c]]}return o[n[n.length-1]]=e,s}function De(t,{from:e,to:r},n){const s=D(t,n);if(!Array.isArray(s))return n;const o=[...s],c=s[e];return o.splice(e,1),o.splice(r,0,c),v(t,o,n)}function Oe(t,e,r,n){const s=D(t,n);if(!Array.isArray(s))return n;const o=[...s];return o.splice(typeof r=="number"?r:o.length,0,e),v(t,o,n)}function Ce(t,e,r){const n=D(t,r);return Array.isArray(n)?v(t,n.filter((s,o)=>o!==e),r):r}function we(t,e,r,n){const s=D(t,n);if(!Array.isArray(s)||s.length<=r)return n;const o=[...s];return o[r]=e,v(t,o,n)}function he({$values:t,$errors:e,$status:r}){const n=l.useCallback((f,u)=>{r.clearFieldDirty(f),e.setErrors(a=>ke(f,u,a)),t.setValues({values:De(f,u,t.refValues.current),updateState:!0})},[]),s=l.useCallback((f,u)=>{r.clearFieldDirty(f),e.setErrors(a=>ee(f,u,a,-1)),t.setValues({values:Ce(f,u,t.refValues.current),updateState:!0})},[]),o=l.useCallback((f,u,a)=>{r.clearFieldDirty(f),e.setErrors(E=>ee(f,a,E,1)),t.setValues({values:Oe(f,u,a,t.refValues.current),updateState:!0})},[]),c=l.useCallback((f,u,a)=>{r.clearFieldDirty(f),t.setValues({values:we(f,a,u,t.refValues.current),updateState:!0})},[]);return{reorderListItem:n,removeListItem:s,insertListItem:o,replaceListItem:c}}var U,re;function $e(){return re||(re=1,U=function t(e,r){if(e===r)return!0;if(e&&r&&typeof e=="object"&&typeof r=="object"){if(e.constructor!==r.constructor)return!1;var n,s,o;if(Array.isArray(e)){if(n=e.length,n!=r.length)return!1;for(s=n;s--!==0;)if(!t(e[s],r[s]))return!1;return!0}if(e.constructor===RegExp)return e.source===r.source&&e.flags===r.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===r.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===r.toString();if(o=Object.keys(e),n=o.length,n!==Object.keys(r).length)return!1;for(s=n;s--!==0;)if(!Object.prototype.hasOwnProperty.call(r,o[s]))return!1;for(s=n;s--!==0;){var c=o[s];if(!t(e[c],r[c]))return!1}return!0}return e!==e&&r!==r}),U}var Re=$e();const K=ge(Re);function N(t,e){const r=Object.keys(t);if(typeof e=="string"){const n=r.filter(s=>s.startsWith(`${e}.`));return t[e]||n.some(s=>t[s])||!1}return r.some(n=>t[n])}function Te({initialDirty:t,initialTouched:e,mode:r,$values:n}){const[s,o]=l.useState(e),[c,f]=l.useState(t),u=l.useRef(e),a=l.useRef(t),E=l.useCallback(y=>{const S=typeof y=="function"?y(u.current):y;u.current=S,r==="controlled"&&o(S)},[]),p=l.useCallback((y,S=!1)=>{const F=typeof y=="function"?y(a.current):y;a.current=F,(r==="controlled"||S)&&f(F)},[]),j=l.useCallback(()=>E({}),[]),L=l.useCallback(y=>{const S=y?{...n.refValues.current,...y}:n.refValues.current;n.setValuesSnapshot(S),p({})},[]),_=l.useCallback((y,S)=>{E(F=>N(F,y)===S?F:{...F,[y]:S})},[]),d=l.useCallback((y,S,F)=>{p(w=>N(w,y)===S?w:{...w,[y]:S},F)},[]),b=l.useCallback((y,S)=>{const F=N(a.current,y),w=!K(D(y,n.getValuesSnapshot()),S),I=Z(y,a.current);I[y]=w,p(I,F!==w)},[]),g=l.useCallback(y=>N(u.current,y),[]),h=l.useCallback(y=>p(S=>{if(typeof y!="string")return S;const F=Z(y,S);return delete F[y],K(F,S)?S:F}),[]),O=l.useCallback(y=>{if(y){const F=D(y,a.current);if(typeof F=="boolean")return F;const w=D(y,n.refValues.current),I=D(y,n.valuesSnapshot.current);return!K(w,I)}return Object.keys(a.current).length>0?N(a.current):!K(n.refValues.current,n.valuesSnapshot.current)},[]),T=l.useCallback(()=>a.current,[]),C=l.useCallback(()=>u.current,[]);return{touchedState:s,dirtyState:c,touchedRef:u,dirtyRef:a,setTouched:E,setDirty:p,resetDirty:L,resetTouched:j,isTouched:g,setFieldTouched:_,setFieldDirty:d,setTouchedState:o,setDirtyState:f,clearFieldDirty:h,isDirty:O,getDirty:T,getTouched:C,setCalculatedFieldDirty:b}}function Ae({initialValues:t,onValuesChange:e,mode:r}){const n=l.useRef(!1),[s,o]=l.useState(t||{}),c=l.useRef(s),f=l.useRef(s),u=l.useCallback(({values:d,subscribers:b,updateState:g=!0,mergeWithPreviousValues:h=!0})=>{const O=c.current,T=d instanceof Function?d(c.current):d,C=h?{...O,...T}:T;c.current=C,g&&o(C),e==null||e(C,O),b==null||b.filter(Boolean).forEach(y=>y({updatedValues:C,previousValues:O}))},[e]),a=l.useCallback(d=>{var h;const b=D(d.path,c.current),g=d.value instanceof Function?d.value(b):d.value;if(b!==g){const O=c.current,T=v(d.path,g,c.current);u({values:T,updateState:d.updateState}),(h=d.subscribers)==null||h.filter(Boolean).forEach(C=>C({path:d.path,updatedValues:T,previousValues:O}))}},[u]),E=l.useCallback(d=>{f.current=d},[]),p=l.useCallback((d,b)=>{n.current||(n.current=!0,u({values:d,updateState:r==="controlled"}),E(d),b())},[u]),j=l.useCallback(()=>{u({values:f.current,updateState:!0,mergeWithPreviousValues:!1})},[u]),L=l.useCallback(()=>c.current,[]),_=l.useCallback(()=>f.current,[]);return{initialized:n,stateValues:s,refValues:c,valuesSnapshot:f,setValues:u,setFieldValue:a,resetValues:j,setValuesSnapshot:E,initialize:p,getValues:L,getValuesSnapshot:_}}function Ie({$status:t}){const e=l.useRef({}),r=l.useCallback((s,o)=>{l.useEffect(()=>(e.current[s]=e.current[s]||[],e.current[s].push(o),()=>{e.current[s]=e.current[s].filter(c=>c!==o)}),[o])},[]),n=l.useCallback(s=>e.current[s]?e.current[s].map(o=>c=>o({previousValue:D(s,c.previousValues),value:D(s,c.updatedValues),touched:t.isTouched(s),dirty:t.isDirty(s)})):[],[]);return{subscribers:e,watch:r,getFieldSubscribers:n}}function se(t,e){return t?`${t}-${e.toString()}`:e.toString()}const W=Symbol("root-rule");function ne(t){const e=X(t);return{hasErrors:Object.keys(e).length>0,errors:e}}function J(t,e,r="",n={}){return typeof t!="object"||t===null?n:Object.keys(t).reduce((s,o)=>{const c=t[o],f=`${r===""?"":`${r}.`}${o}`,u=D(f,e);let a=!1;return typeof c=="function"&&(s[f]=c(u,e,f)),typeof c=="object"&&Array.isArray(u)&&(a=!0,u.forEach((E,p)=>J(c,e,`${f}.${p}`,s)),W in c&&(s[f]=c[W](u,e,f))),typeof c=="object"&&typeof u=="object"&&u!==null&&(a||J(c,e,f,s),W in c&&(s[f]=c[W](u,e,f))),s},n)}function Q(t,e){return ne(typeof t=="function"?t(e):J(t,e))}function B(t,e,r){if(typeof t!="string")return{hasError:!1,error:null};const n=Q(e,r),s=Object.keys(n.errors).find(o=>t.split(".").every((c,f)=>c===o.split(".")[f]));return{hasError:!!s,error:s?n.errors[s]:null}}const Le="__MANTINE_FORM_INDEX__";function oe(t,e){return e?typeof e=="boolean"?e:Array.isArray(e)?e.includes(t.replace(/[.][0-9]+/g,`.${Le}`)):!1:!1}function _e({name:t,mode:e="controlled",initialValues:r,initialErrors:n={},initialDirty:s={},initialTouched:o={},clearInputErrorOnChange:c=!0,validateInputOnChange:f=!1,validateInputOnBlur:u=!1,onValuesChange:a,transformValues:E=d=>d,enhanceGetInputProps:p,validate:j,onSubmitPreventDefault:L="always",touchTrigger:_="change"}={}){const d=je(n),b=Ae({initialValues:r,onValuesChange:a,mode:e}),g=Te({initialDirty:s,initialTouched:o,$values:b,mode:e}),h=he({$values:b,$errors:d,$status:g}),O=Ie({$status:g}),[T,C]=l.useState(0),[y,S]=l.useState({}),[F,w]=l.useState(!1),I=l.useCallback(()=>{b.resetValues(),d.clearErrors(),g.resetDirty(),g.resetTouched(),e==="uncontrolled"&&C(i=>i+1)},[]),M=l.useCallback(i=>{c&&d.clearErrors(),e==="uncontrolled"&&C(V=>V+1),Object.keys(O.subscribers.current).forEach(V=>{const m=D(V,b.refValues.current),$=D(V,i);m!==$&&O.getFieldSubscribers(V).forEach(A=>A({previousValues:i,updatedValues:b.refValues.current}))})},[c]),ue=l.useCallback(i=>{const V=b.refValues.current;b.initialize(i,()=>e==="uncontrolled"&&C(m=>m+1)),M(V)},[M]),Y=l.useCallback((i,V,m)=>{const $=oe(i,f),A=V instanceof Function?V(D(i,b.refValues.current)):V;g.setCalculatedFieldDirty(i,A),_==="change"&&g.setFieldTouched(i,!0),!$&&c&&d.clearFieldError(i),b.setFieldValue({path:i,value:V,updateState:e==="controlled",subscribers:[...O.getFieldSubscribers(i),$?q=>{const R=B(i,j,q.updatedValues);R.hasError?d.setFieldError(i,R.error):d.clearFieldError(i)}:null,(m==null?void 0:m.forceUpdate)!==!1&&e!=="controlled"?()=>S(q=>({...q,[i]:(q[i]||0)+1})):null]})},[a,j]),ie=l.useCallback(i=>{const V=b.refValues.current;b.setValues({values:i,updateState:e==="controlled"}),M(V)},[a,M]),G=l.useCallback(()=>{const i=Q(j,b.refValues.current);return d.setErrors(i.errors),i},[j]),le=l.useCallback(i=>{const V=B(i,j,b.refValues.current);return V.hasError?d.setFieldError(i,V.error):d.clearFieldError(i),V},[j]),ae=(i,{type:V="input",withError:m=!0,withFocus:$=!0,...A}={})=>{const R={onChange:me(z=>Y(i,z,{forceUpdate:!1})),"data-path":se(t,i)};return m&&(R.error=d.errorsState[i]),V==="checkbox"?R[e==="controlled"?"checked":"defaultChecked"]=D(i,b.refValues.current):R[e==="controlled"?"value":"defaultValue"]=D(i,b.refValues.current),$&&(R.onFocus=()=>g.setFieldTouched(i,!0),R.onBlur=()=>{if(oe(i,u)){const z=B(i,j,b.refValues.current);z.hasError?d.setFieldError(i,z.error):d.clearFieldError(i)}}),Object.assign(R,p==null?void 0:p({inputProps:R,field:i,options:{type:V,withError:m,withFocus:$,...A},form:H}))},fe=(i,V)=>m=>{L==="always"&&(m==null||m.preventDefault());const $=G();if($.hasErrors)L==="validation-failed"&&(m==null||m.preventDefault()),V==null||V($.errors,b.refValues.current,m);else{const A=i==null?void 0:i(E(b.refValues.current),m);A instanceof Promise&&(w(!0),A.finally(()=>w(!1)))}},de=i=>E(i||b.refValues.current),be=l.useCallback(i=>{i.preventDefault(),I()},[]),ye=l.useCallback(i=>i?!B(i,j,b.refValues.current).hasError:!Q(j,b.refValues.current).hasErrors,[j]),Ee=i=>`${T}-${i}-${y[i]||0}`,Ve=l.useCallback(i=>document.querySelector(`[data-path="${se(t,i)}"]`),[]),H={watch:O.watch,initialized:b.initialized.current,values:b.stateValues,getValues:b.getValues,getInitialValues:b.getValuesSnapshot,setInitialValues:b.setValuesSnapshot,initialize:ue,setValues:ie,setFieldValue:Y,submitting:F,setSubmitting:w,errors:d.errorsState,setErrors:d.setErrors,setFieldError:d.setFieldError,clearFieldError:d.clearFieldError,clearErrors:d.clearErrors,resetDirty:g.resetDirty,setTouched:g.setTouched,setDirty:g.setDirty,isTouched:g.isTouched,resetTouched:g.resetTouched,isDirty:g.isDirty,getTouched:g.getTouched,getDirty:g.getDirty,reorderListItem:h.reorderListItem,insertListItem:h.insertListItem,removeListItem:h.removeListItem,replaceListItem:h.replaceListItem,reset:I,validate:G,validateField:le,getInputProps:ae,onSubmit:fe,onReset:be,isValid:ye,getTransformedValues:de,key:Ee,getInputNode:Ve};return Fe(t,H),H}export{_e as u};
