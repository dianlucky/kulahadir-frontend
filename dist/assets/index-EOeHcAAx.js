import{r as l,j as e,B as i,P as z,T as x,D as u,z as E,A as ge,C as F,N as G}from"./index-DB885r8G.js";import{u as pe,a as fe,b as be,c as ke,d as Te,e as ye,M as ve}from"./deleteTaskEmployee-CYIPWxia.js";import{g as qe,f as Ye,i as Qe,p as Ue,j as Xe,h as Ze}from"./deleteTaskEmployee-CYIPWxia.js";import{T as s}from"./Table-8nKp-RGz.js";import{I as V}from"./IconTrash-CJqVm7PQ.js";import{I as Ne}from"./IconAdjustments-_9fsS69j.js";import{S as P}from"./Select-uZaPD1q6.js";import{u as we}from"./getEmployee-BJ8P6zZa.js";import{u as W}from"./use-form-R8rP4jg8.js";import{I as Se}from"./IconEye-_EpxN4HS.js";import{C as I}from"./Collapse-BsDTvhXW.js";import{I as J}from"./IconPencil-ohpWopQ4.js";import{T as L}from"./TextInput-BRteoBJL.js";import"./InputBase-CS1WPbx0.js";import"./Input-ZQfrt0AG.js";import"./CheckIcon-CUDbF6ID.js";import"./get-style-object-DUJZA7T_.js";const De=({taskEmployees:b,daySelect:k,setDaySelect:T,setDeleteTask:y,setTaskEmployee:v})=>{const[N,j]=l.useState(!1),d=b.map((c,r)=>e.jsxs(s.Tr,{children:[e.jsx(s.Td,{children:r+1}),e.jsx(s.Td,{children:c==null?void 0:c.day}),e.jsx(s.Td,{children:c.task.task_code}),e.jsx(s.Td,{children:c.employee.name}),e.jsx(s.Td,{className:"w-40",children:e.jsx(i,{size:"xs",color:"red",onClick:()=>{y(!0),v(c)},children:e.jsx(V,{})})})]},r));return e.jsxs("section",{className:"bg-white shadow-lg p-6 rounded-lg",children:[e.jsxs(z,{width:250,position:"bottom",withArrow:!0,shadow:"md",opened:N,closeOnClickOutside:!0,children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{children:e.jsx("div",{className:"text-dark font-semibold cursor-pointer text-lg",children:"Tugas mingguan pegawai"})}),e.jsx("div",{children:e.jsx(z.Target,{children:e.jsx(i,{size:"xs",onClick:()=>j(c=>!c),children:e.jsx(Ne,{color:"white"})})})})]}),e.jsx(z.Dropdown,{children:e.jsxs("div",{className:"mt-2",children:[e.jsxs("div",{className:"mb-3",children:[e.jsx(x,{size:"sm",fw:"bolder",children:"Filter"}),e.jsx(u,{className:"mb-2"}),e.jsx(P,{label:"Hari",size:"xs",value:k,onChange:T,data:[{label:"Senin",value:"Senin"},{label:"Selasa",value:"Selasa"},{label:"Rabu",value:"Rabu"},{label:"Kamis",value:"Kamis"},{label:"Jumat",value:"Jumat"},{label:"Sabtu",value:"Sabtu"},{label:"Minggu",value:"Minggu"}]})]}),e.jsx(u,{}),e.jsx("div",{children:e.jsx(i,{fullWidth:!0,size:"xs",onClick:()=>j(!1),children:"Simpan"})})]})})]}),e.jsx("div",{className:"mt-3",children:e.jsxs(s,{striped:!0,highlightOnHover:!0,withTableBorder:!0,withColumnBorders:!0,className:"text-dark font-semibold cursor-pointer text-sm",children:[e.jsx(s.Thead,{children:e.jsxs(s.Tr,{children:[e.jsx(s.Th,{className:"font-semibold",children:"No"}),e.jsx(s.Th,{className:"font-semibold",children:"Hari"}),e.jsx(s.Th,{className:"font-semibold",children:"Kode tugas"}),e.jsx(s.Th,{className:"font-semibold",children:"Pegawai"}),e.jsx(s.Th,{className:"font-semibold",children:"Aksi"})]})}),e.jsx(s.Tbody,{children:d})]})})]})},Je=()=>{const[b,{toggle:k}]=E(!1),[T,{toggle:y}]=E(!1),[v,{toggle:N}]=E(!1),[j,d]=l.useState(!1),[c,r]=l.useState(!1),[q,g]=l.useState(!1),[Y,B]=l.useState(!1),[t,Q]=l.useState(),[m,U]=l.useState(),[X,Z]=l.useState([]),{data:w}=we();l.useEffect(()=>{w&&Z(w)},[w]);const $=X.filter(a=>a.account&&a.account.level==="Pegawai").map(a=>({value:a.id.toString(),label:a.name})),[M,ee]=l.useState([]),{data:S,refetch:K}=pe();l.useEffect(()=>{S&&ee(S)},[S]);const se=M.map(a=>({value:a.id.toString(),label:a.task_code})),ae=M.map((a,n)=>e.jsxs(s.Tr,{children:[e.jsx(s.Td,{children:n+1}),e.jsx(s.Td,{children:a.task_code}),e.jsx(s.Td,{children:a.task_name}),e.jsx(s.Td,{className:"w-40",children:e.jsx(i,{size:"xs",color:"red",onClick:()=>{g(!0),U(a)},children:e.jsx(V,{})})})]},n)),o=W({validateInputOnChange:!0,initialValues:{task_code:"",task_name:""},validate:{task_name:a=>a.length<10?"Minimal 10 karakter":null,task_code:a=>a.length<2?"Minimal 2 karakter":null}}),le=fe(),te=async a=>{if(a.preventDefault(),!o.isValid())return;const n={id:null,task_code:o.values.task_code,task_name:o.values.task_name};await le.mutateAsync(n,{onSuccess:_=>{console.log("Success:",_),d(!0),o.reset(),K(),close(),setTimeout(()=>{d(!1)},4500)}})},ie=be(),ce=async a=>{ie.mutateAsync(a,{onSuccess:n=>{console.log("Success Delete:",n),r(!0),g(!1),K(),close(),setTimeout(()=>{r(!1)},4500)}})},[p,ne]=l.useState("Senin"),[R,oe]=l.useState([]),{data:D,refetch:f,isLoading:H}=ke(p);l.useEffect(()=>{D&&oe(D)},[D]),l.useEffect(()=>{p&&f()},[p,f]),console.log("Data task employee :",R);const[C,O]=l.useState([]),h=W({validateInputOnChange:!0,initialValues:{day:"",employee_id:""}}),re=Te(),de=async a=>{if(a.preventDefault(),C.length===0){console.error("Tidak ada kode tugas yang dipilih.");return}const n=h.values.day,_=parseInt(h.values.employee_id);try{const A=C.map(he=>{const xe=parseInt(he),je={day:n,employee_id:_,task_id:xe};return re.mutateAsync(je)});await Promise.all(A),console.log("Semua data berhasil dikirim!"),d(!0),h.reset(),O([]),f(),close(),setTimeout(()=>d(!1),4500)}catch(A){console.error("Gagal mengirim data:",A)}},me=ye(),ue=async a=>{me.mutateAsync(a,{onSuccess:n=>{console.log("Success Delete:",n),r(!0),B(!1),f(),close(),setTimeout(()=>{r(!1)},4500)}})};return H?e.jsx("div",{className:"w-full flex justify-center",children:e.jsx(ge,{})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid lg:grid-cols-12 gap-6",children:[e.jsxs("div",{className:"col-span-9",children:[e.jsxs("section",{className:"bg-white shadow-lg p-6 rounded-lg",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{children:e.jsx("div",{className:"text-dark font-semibold cursor-pointer text-lg",children:"Daftar tugas"})}),e.jsx("div",{className:"mr-1",children:e.jsx(i,{color:"blue",className:"shadow-lg",size:"xs",onClick:N,children:e.jsx(Se,{size:20,color:"white"})})})]}),e.jsx(I,{in:v,children:e.jsx("div",{className:"mt-3",children:e.jsxs(s,{striped:!0,highlightOnHover:!0,withTableBorder:!0,withColumnBorders:!0,className:"text-dark font-semibold cursor-pointer text-sm",children:[e.jsx(s.Thead,{children:e.jsxs(s.Tr,{children:[e.jsx(s.Th,{className:"font-semibold",children:"No"}),e.jsx(s.Th,{className:"font-semibold",children:"Kode tugas"}),e.jsx(s.Th,{className:"font-semibold",children:"Nama tugas"}),e.jsx(s.Th,{className:"font-semibold",children:"Aksi"})]})}),e.jsx(s.Tbody,{children:ae})]})})})]}),!H&&e.jsx("section",{children:e.jsx("div",{className:"mt-2",children:e.jsx(De,{taskEmployees:R,daySelect:p,setDaySelect:ne,setDeleteTask:B,setTaskEmployee:Q})})})]}),e.jsxs("div",{className:"col-span-3",children:[e.jsx("section",{className:"col-span-4 bg-white shadow-lg p-6 rounded-lg",children:e.jsxs("div",{children:[e.jsxs("div",{className:"grid grid-cols-12 gap-2",children:[e.jsx("div",{className:"col-span-10 text-dark font-semibold cursor-pointer text-lg mb-2",children:"Tambah tugas"}),e.jsx("div",{className:"col-span-2 -mt-1",children:e.jsx(i,{color:"blue",className:"shadow-lg",size:"xs",onClick:k,children:e.jsx(J,{size:20,color:"white"})})})]}),e.jsx(u,{}),e.jsx("div",{className:"mt-2",children:e.jsx(I,{in:b,children:e.jsxs("form",{onSubmit:te,children:[e.jsx(L,{size:"md",label:"Kode tugas",className:"mb-2",placeholder:"Tugas",...o.getInputProps("task_code")},o.key("task_code")),e.jsx(L,{size:"md",label:"Nama tugas",className:"mb-4",placeholder:"Tugas",...o.getInputProps("task_name")},o.key("task_name")),e.jsx("div",{className:"flex justify-center",children:e.jsx(i,{type:"submit",fullWidth:!0,children:"Simpan"})})]})})})]})}),e.jsx("section",{className:"col-span-4 bg-white shadow-lg p-6 rounded-lg mt-2",children:e.jsxs("div",{children:[e.jsxs("div",{className:"grid grid-cols-12 gap-2",children:[e.jsx("div",{className:"col-span-10 text-dark font-semibold cursor-pointer text-lg mb-2",children:"Tambah tugas mingguan"}),e.jsx("div",{className:"col-span-2 -mt-1",children:e.jsx(i,{color:"blue",className:"shadow-lg",size:"xs",onClick:y,children:e.jsx(J,{size:20,color:"white"})})})]}),e.jsx(u,{}),e.jsx("div",{className:"mt-2",children:e.jsx(I,{in:T,children:e.jsxs("form",{onSubmit:de,children:[e.jsx(P,{label:"Hari",size:"sm",withAsterisk:!0,data:[{label:"Senin",value:"Senin"},{label:"Selasa",value:"Selasa"},{label:"Rabu",value:"Rabu"},{label:"Kamis",value:"Kamis"},{label:"Jumat",value:"Jumat"},{label:"Sabtu",value:"Sabtu"},{label:"Minggu",value:"Minggu"}],...h.getInputProps("day")}),e.jsx(P,{withAsterisk:!0,label:"Pegawai",placeholder:"Pegawai",data:$,...h.getInputProps("employee_id")}),e.jsx(ve,{withAsterisk:!0,label:"Kode tugas",placeholder:"Kode tugas",data:se,value:C,onChange:O}),e.jsx("div",{className:"flex justify-center mt-3",children:e.jsx(i,{type:"submit",fullWidth:!0,children:"Simpan"})})]})})})]})}),q?e.jsx("section",{className:"col-span-4 bg-white shadow-lg p-6 rounded-lg mt-2",children:e.jsxs("div",{children:[e.jsxs("div",{className:"grid grid-cols-12",children:[e.jsx("div",{className:"col-span-10 text-dark font-semibold cursor-pointer text-lg mb-2",children:"Hapus tugas"}),e.jsx(F,{onClick:()=>g(!1),className:"col-span-2 flex left-1"})]}),e.jsx(u,{}),e.jsxs("div",{className:"mt-4 text-center",children:[e.jsx(x,{size:"md",fw:500,children:"Apakah anda yakin ingin menghapus data tugas ?"}),e.jsxs(x,{size:"md",c:"red",fw:600,children:['"',m==null?void 0:m.task_name,'"']})]}),e.jsx("div",{className:"flex justify-center mt-2",children:e.jsx(i,{onClick:()=>ce(m==null?void 0:m.id),type:"submit",color:"red",children:"Ya!"})})]})}):"",Y?e.jsx("section",{className:"col-span-4 bg-white shadow-lg p-6 rounded-lg mt-2",children:e.jsxs("div",{children:[e.jsxs("div",{className:"grid grid-cols-12",children:[e.jsx("div",{className:"col-span-10 text-dark font-semibold cursor-pointer text-lg mb-2",children:"Hapus tugas mingguan"}),e.jsx(F,{onClick:()=>g(!1),className:"col-span-2 flex left-1"})]}),e.jsx(u,{}),e.jsxs("div",{className:"mt-4 text-center",children:[e.jsx(x,{size:"md",fw:500,children:"Apakah anda yakin ingin menghapus data tugas mingguan?"}),e.jsxs(x,{size:"md",c:"red",fw:600,children:['"',t==null?void 0:t.day,'" | "',t==null?void 0:t.employee.name,'" | "',t==null?void 0:t.task.task_name,'"']})]}),e.jsx("div",{className:"flex justify-center mt-2",children:e.jsx(i,{onClick:()=>ue(t==null?void 0:t.id),type:"submit",color:"red",children:"Ya!"})})]})}):""]})]}),e.jsxs("div",{className:"fixed bottom-4 right-4 z-50 w-100",children:[j&&e.jsx(G,{color:"teal",title:"Berhasil!",mt:"md",children:"Data berhasil ditambahkan"}),c&&e.jsx(G,{color:"teal",title:"Berhasil!",mt:"md",children:"Data berhasil dihapus"})]})]})};export{Je as DailyTaskPage,De as WeeklyTaskSection,qe as getAllDailyTask,Ye as getAllTaskEmployee,Qe as getTaskEmployeeByDay,Ue as postDailyTasks,Xe as postTaskEmployee,fe as useCreateDailyTask,Te as useCreateTaskEmployee,be as useDeleteDailyTask,ye as useDeleteTaskEmployee,pe as useGetAllDailyTask,Ze as useGetAllTaskEmployee,ke as useGetTaskByDay};
