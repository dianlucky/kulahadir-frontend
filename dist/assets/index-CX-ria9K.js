import{h as k,r as t,j as s,T as r,D as d,c as h,i as b,a8 as _,b as I}from"./index-62kOrHCL.js";import{u as T,a as A}from"./getSchedule-BwEkCXPp.js";import{I as B}from"./IconCalendar-B9aPoEdi.js";import{D as F}from"./DatePicker-gd_gvPyw.js";import{B as H}from"./Badge-C41VQzaz.js";import{I as D}from"./IconClockHour8-CCsIW-KX.js";import{I as Y}from"./IconSquareCheckFilled-CBxfa0Lt.js";import{a as L}from"./getAttendance-CxloHYaj.js";import{u as R}from"./getDailyTaskEmployee-BERthAp2.js";import{I as G}from"./IconChevronLeft-3Kw0OlEi.js";import"./use-dates-state-DKWOd2wD.js";const J=({setDate:e})=>{const{creds:a}=k(),[o,p]=t.useState(new Date),[n,j]=t.useState(new Date().getMonth()+1),[x,y]=t.useState(new Date().getFullYear());console.log("bulan : ",n,x);const u=i=>{j(i.getMonth()+1),y(i.getFullYear())},g=i=>{if(p(i),i){const m=h(i,"yyyy-MM-dd");e(m)}},[l,v]=t.useState([]),{data:f,refetch:N,isLoading:c}=T(`${x}-${n}`,a==null?void 0:a.employee_id);t.useEffect(()=>{f&&v(f)},[f]),t.useEffect(()=>{N()},[n,x]);const z=t.useMemo(()=>c||!Array.isArray(l)||l.length===0?[]:l.filter(i=>i.status==="off").map(i=>{const m=new Date(i.date);return{day:m.getDate(),month:m.getMonth()+1,year:m.getFullYear()}}),[l,c]);return s.jsxs("section",{className:"mx-auto max-w-sm bg-white w-full shadow-lg rounded-xl z-50 relative p-2 px-2 text-slate-700 mb-2 mt-2",children:[s.jsxs("div",{className:"flex justify-between text-xs items-center p-2 -mt-1 -mb-1",children:[s.jsx("div",{children:s.jsx(r,{fw:700,c:"#654433",children:"Kalender"})}),s.jsx("div",{className:"my-auto text-right -mt-2 me-2",children:s.jsx(B,{})})]}),s.jsx(d,{size:"sm"}),s.jsx("div",{className:"flex justify-center",children:s.jsx(F,{value:o,onChange:g,onNextMonth:u,onPreviousMonth:u,renderDay:i=>{const m=i.getDate(),M=i.getMonth()+1,E=i.getFullYear(),C=z.some(w=>w.day===m&&w.month===M&&w.year===E)?"bg-red-400 text-white":"";return s.jsx("div",{className:`w-full h-full flex items-center justify-center rounded ${C}`,children:m})}})}),s.jsx("div",{className:"mt-2 mb-2 px-4",children:s.jsx("div",{className:"grid grid-cols-9"})})]})},K=({selectedSchedule:e,attendance:a})=>(console.log("Kehadiran :",a),console.log("Jadwal :",e),s.jsxs("section",{className:"mx-auto max-w-sm bg-white  w-full shadow-lg rounded-xl z-50 relative p-2 px-2 text-slate-700 mb-4",children:[s.jsxs("div",{className:"flex justify-between text-xs items-center p-2 -mt-1 -mb-1",children:[s.jsx("div",{children:s.jsx(r,{fw:700,c:"#654433",children:"Jadwal"})}),s.jsx("div",{className:"my-auto text-right -mt-2 me-2",children:s.jsx(H,{size:"sm",className:"uppercase",style:{marginTop:"7px",marginLeft:"4px",borderRadius:"2px"},color:(e==null?void 0:e.status)=="on"?"green":"red",children:e==null?void 0:e.status})})]}),s.jsx(d,{size:"sm"}),s.jsxs("div",{className:"divide-y divide-gray-300",children:[s.jsxs("div",{className:"w-full grid grid-cols-12 divide-x divide-gray-300 p-1 -mb-2",children:[s.jsxs("div",{className:"col-span-3 text-center m-auto p-1",children:[s.jsx(r,{size:"28px",fw:700,children:e==null?void 0:e.shift_code}),s.jsx(r,{style:{marginTop:"-5px"},size:"sm",children:"Malam"})]}),s.jsxs("div",{className:"col-span-9 ms-2 text-left",children:[s.jsxs("div",{className:"ms-2 -mb-2",children:[s.jsx(r,{size:"xs",children:"Hari & tanggal : "}),s.jsx(r,{size:"sm",fw:700,children:e!=null&&e.date?h(e.date,"EEEE, dd MMM yyyy",{locale:b}):""})]}),s.jsx(d,{my:"sm"}),s.jsxs("div",{className:"-mt-2 w-full grid grid-cols-12 mb-1",children:[s.jsxs("div",{className:"col-span-6 text-left mt-1 ms-2",children:[s.jsx(r,{size:"xs",children:"Jam kerja"}),s.jsxs(r,{size:"sm",fw:700,children:[e==null?void 0:e.start_time," - ",e==null?void 0:e.end_time]})]}),s.jsx("div",{className:"col-span-6 text-right -mt-1"})]})]})]}),s.jsx(d,{}),s.jsxs("div",{className:"flex justify-between text-xs p-2",children:[s.jsxs("div",{className:"flex gap-2",children:[s.jsx(D,{size:15,className:"text-green-400"})," Masuk :"," ",a!=null&&a.check_in?h(new Date(a.check_in),"HH:mm",{locale:b}):"--:--"]}),s.jsx("div",{className:"ml-5",children:s.jsx("div",{className:"w-px h-full bg-gray-300 mx-4"})}),s.jsxs("div",{className:"flex gap-2 mx-auto",children:[s.jsx(D,{size:15,className:"text-rose-400"})," ",s.jsxs(r,{size:"xs",mt:-2,ml:-5,children:["Keluar :"," ",a!=null&&a.check_out?h(new Date(a.check_out),"HH:mm",{locale:b}):"--:--"]})]})]})]})]})),P=({dailyTask:e})=>s.jsx(s.Fragment,{children:s.jsxs("section",{className:"bg-white mx-auto max-w-sm w-full shadow-lg rounded-xl z-50 relative p-4",children:[s.jsxs("div",{className:"flex justify-between text-xs items-center mb-2",children:[s.jsx("span",{className:"text-base font-bold text-brown",children:"Tugas harian"}),s.jsx(_,{size:22})]}),s.jsx(d,{size:"xs",className:"mb-2"}),e.length!=0&&e.map((a,o)=>s.jsxs("div",{children:[s.jsxs("div",{className:"grid grid-cols-12 px-1",children:[s.jsx("div",{className:"col-span-1 m-auto",children:s.jsx(r,{fw:700,size:"sm",children:a.task_employee.task.task_code})}),s.jsx("div",{className:"col-span-1 ml-1",children:s.jsx("div",{className:"w-px h-full bg-gray-300 mx-4"})}),s.jsx("div",{className:"col-span-9 ml-1 my-auto",children:s.jsx(r,{size:"12px",lineClamp:2,children:a.task_employee.task.task_name})}),s.jsx("div",{className:"col-span-1 ",children:a.status=="Sudah"&&s.jsx("div",{style:{marginLeft:"-2px"},children:s.jsx(Y,{color:"#77B254"})})})]}),s.jsx("div",{className:"mt-2 mb-2",children:s.jsx(d,{})})]},o))]})}),as=()=>{const{creds:e}=k(),a=I(),[o,p]=t.useState(h(new Date,"yyyy-MM-dd")),[n,j]=t.useState(),{data:x,refetch:y}=A(e==null?void 0:e.employee_id,o);t.useEffect(()=>{y()},[o]),t.useEffect(()=>{j(x||void 0)},[x]);const[u,g]=t.useState(),{data:l,refetch:v}=L(n==null?void 0:n.id);t.useEffect(()=>{n!=null&&n.id&&v()},[n]),t.useEffect(()=>{g(l||void 0)},[l]);const[f,N]=t.useState([]),{data:c}=R(o,e==null?void 0:e.employee_id);return t.useEffect(()=>{c&&N(c)},[c]),s.jsxs("main",{children:[s.jsx("section",{className:"w-full h-20 bg-brown rounded-b-3xl"}),s.jsx("section",{className:"bg-white mx-5 p-3 shadow-md rounded-lg flex flex-col gap-2 -mt-10",children:s.jsxs("div",{className:"grid grid-cols-12",children:[s.jsx("div",{className:"col-span-1",children:s.jsx(G,{onClick:()=>{a(-1)},size:21,className:"font-bold rounded-md"})}),s.jsx("div",{className:"col-span-11 text-center -ml-4 font-semibold text-brown",children:s.jsx("h2",{className:"font-semibold",children:"Jadwal bulanan"})})]})}),s.jsx("div",{className:"mx-5",children:s.jsx(J,{setDate:p})}),s.jsx("div",{className:"mx-5",children:s.jsx(K,{selectedSchedule:n,attendance:u})}),s.jsx("div",{className:"mb-20 -mt-2 mx-5",children:s.jsx(P,{dailyTask:f})})]})};export{as as SchedulePage};
