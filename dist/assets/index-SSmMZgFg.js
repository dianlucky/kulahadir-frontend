import{e as S,s as T,d as M,r as k,z as I,j as e,D as E,T as x,b6 as p,B as d,b7 as U,a5 as K,$ as g,b as F,U as P}from"./index-DB885r8G.js";import{u as A}from"./use-form-R8rP4jg8.js";import{I as L}from"./IconCategory-DsLTNsrk.js";import{I as W}from"./IconPencil-ohpWopQ4.js";import{I as R}from"./IconTrash-CJqVm7PQ.js";import{T as $}from"./TextInput-BRteoBJL.js";import{T as B}from"./Textarea-gOXdisOz.js";import{u as V,C as G}from"./CategorySkeleton-wDe2VFKQ.js";import{g as be}from"./CategorySkeleton-wDe2VFKQ.js";import{I as H}from"./IconChevronLeft-uQ5EpKgH.js";import{I as O}from"./IconPlus-DrN9tJvO.js";import"./InputBase-CS1WPbx0.js";import"./Input-ZQfrt0AG.js";import"./Skeleton-CtlNFUgh.js";const q="https://dianlucky.my.id/api",Y=async a=>(await S.post(`${q}/categories/`,a,{headers:{Authorization:`Bearer ${T.getToken()}`}})).data,J=()=>M({mutationFn:Y,onMutate:async()=>{},onError:a=>{console.log("Error :",a)}}),Q="https://dianlucky.my.id/api",X=async a=>(await S.delete(`${Q}/categories/${a}`,{headers:{Authorization:`Bearer ${T.getToken()}`}})).data,Z=()=>M({mutationFn:a=>X(a),onError:a=>{console.log(a)}}),_="https://dianlucky.my.id/api";async function ee(a,i){return(await S.patch(`${_}/categories/${a}`,i,{headers:{Authorization:`Bearer ${T.getToken()}`}})).data}const se=a=>M({mutationFn:i=>ee(a,i)}),ae=({categories:a,RefetchCategories:i})=>{const[s,l]=k.useState(),[y,{open:j,close:r}]=I(!1),[f,{open:v,close:o}]=I(!1),N=Z(),w=async n=>{N.mutateAsync(n,{onSuccess:c=>{console.log("Sukses :",c),l(void 0),i(),g({message:"Kategori berhasil dihapus",color:"green",position:"top-center"}),r()},onError:c=>{var b,h;const m=c,u=((h=(b=m==null?void 0:m.response)==null?void 0:b.data)==null?void 0:h.errors)||"Gagal menghapus kategori. Silakan coba lagi.";r(),g({message:u,color:"red",position:"top-center"})}})},t=A({validateInputOnChange:!0,initialValues:{code:s?s.code:"",name:s?s.name:""},validate:{name:n=>n.length<5?"Minimal 5 Karakter":null,code:n=>n.length<2?"Minimal 2 karakter":n.length>4?"Kode Tugas tidak boleh lebih dari 4 karakter":null}}),C=se(s==null?void 0:s.id),z=async n=>{if(n.preventDefault(),!t.isValid())return;const c={code:t.values.code,name:t.values.name};await C.mutateAsync(c,{onSuccess:()=>{i(),o(),g({message:"Kategori berhasil diubah",color:"green",position:"top-center"})},onError:m=>{var h,D;const u=m,b=((D=(h=u==null?void 0:u.response)==null?void 0:h.data)==null?void 0:D.errors)||"Gagal mengubah kategori. Silakan coba lagi.";o(),g({message:b,color:"red",position:"top-center"})}})};return k.useEffect(()=>{s&&t.setValues({code:s.code,name:s.name})},[s]),e.jsxs(e.Fragment,{children:[e.jsxs("section",{className:"bg-white mx-auto max-w-sm w-full shadow-lg rounded-md relative p-4",children:[e.jsxs("div",{className:"flex justify-between text-xs items-center mb-2",children:[e.jsx("span",{className:"text-sm font-bold text-brown",children:"Daftar Kategori"}),e.jsx(L,{size:20})]}),e.jsx(E,{size:"xs",className:"mb-2"}),a.length!=0&&a.map((n,c)=>e.jsxs("div",{children:[e.jsxs("div",{className:"grid grid-cols-12 px-2",children:[e.jsx("div",{className:"col-span-1 m-auto",children:e.jsx(x,{fw:700,size:"md",children:n.code})}),e.jsx("div",{className:"col-span-1 ml-1",children:e.jsx("div",{className:"w-px h-full bg-gray-300 mx-4"})}),e.jsx("div",{className:"col-span-8 ml-1 my-auto",children:e.jsx(x,{size:"xs",lineClamp:2,truncate:"end",children:n.name})}),e.jsx("div",{className:"col-span-2 ml-4 flex gap-1",children:e.jsxs(p,{shadow:"xs",position:"bottom-end",width:100,withArrow:!0,children:[e.jsx(p.Target,{children:e.jsx(d,{color:"gray",disabled:n.name=="Frozen",size:"compact-xs",children:e.jsx(U,{size:18})})}),e.jsxs(p.Dropdown,{children:[e.jsx(p.Item,{onClick:()=>{v(),l(n)},leftSection:e.jsx(W,{size:14}),children:"Edit"}),e.jsx(p.Item,{leftSection:e.jsx(R,{size:14}),onClick:()=>{j(),l(n)},children:"Hapus"})]})]})})]}),e.jsx("div",{className:"mt-2 mb-2",children:e.jsx(E,{})})]},c)),a.length==0&&e.jsx("div",{className:"text-center",children:e.jsx(x,{size:"xs",fw:300,fs:"italic",children:"Kategori tidak ditemukan"})})]}),e.jsx(K,{opened:y,onClose:r,title:"Konfirmasi hapus",children:e.jsxs("div",{className:"px-1",children:[e.jsxs("div",{className:" text-center px-2",children:[e.jsx(x,{size:"sm",fw:500,children:"Apakah anda yakin ingin menghapus kategori dengan kode"}),e.jsxs(x,{size:"sm",c:"red",fw:700,children:['"',s==null?void 0:s.code," || ",s==null?void 0:s.name,'"']})]}),e.jsxs("div",{className:"flex justify-betwen gap-2 mt-2 mb-2",children:[e.jsx(d,{color:"grey",size:"xs",fullWidth:!0,onClick:r,children:"Kembali"}),e.jsx(d,{color:"yellow",size:"xs",fullWidth:!0,onClick:()=>{w(s==null?void 0:s.id)},children:"Ya! Hapus kategori"})]})]})}),e.jsx(K,{opened:f,onClose:o,title:"Edit kategori",children:e.jsx("div",{className:"px-2 -mt-2",children:e.jsxs("form",{onSubmit:z,children:[e.jsx("div",{className:"mt-2",children:e.jsx($,{label:"Kode Kategori",size:"sm",...t.getInputProps("code")},t.key("code"))}),e.jsx("div",{className:"mt-2",children:e.jsx(B,{label:"Nama Kategori",placeholder:"Masukkan nama kategori",size:"sm",...t.getInputProps("name")},t.key("name"))}),e.jsxs("div",{className:"flex justify-between gap-2 mt-4 mb-5",children:[e.jsx(d,{size:"sm",onClick:r,fullWidth:!0,color:"gray",children:"Kembali"}),e.jsx(d,{type:"submit",fullWidth:!0,children:"Simpan"})]})]})})})]})},ge=()=>{const a=F(),[i,{open:s,close:l}]=I(!1),[y,j]=k.useState([]),{data:r,refetch:f,isLoading:v}=V();k.useEffect(()=>{j(r||[])},[r]);const o=A({validateInputOnChange:!0,initialValues:{code:"",name:""},validate:{name:t=>t.length<5?"Minimal 5 Karakter":null,code:t=>t.length<2?"Minimal 2 karakter":t.length>4?"Kode Tugas tidak boleh lebih dari 4 karakter":null}}),N=J(),w=async t=>{if(t.preventDefault(),!o.isValid())return;const C={code:o.values.code,name:o.values.name};await N.mutateAsync(C,{onSuccess:z=>{console.log("Success:",z),o.reset(),f(),g({message:"Berhasil menambahkan kategori baru",color:"green",position:"top-center"}),l()}})};return e.jsxs(e.Fragment,{children:[e.jsx("section",{className:"w-full h-20 bg-brown rounded-b-3xl"}),e.jsx("section",{className:"bg-white mx-5 p-3 shadow-md rounded-lg flex flex-col gap-2 -mt-10",children:e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{children:e.jsx(H,{onClick:()=>{a(-1)},size:21,className:"font-bold rounded-md"})}),e.jsx("div",{className:"font-semibold text-brown",children:e.jsx("h2",{className:"font-semibold",children:"Kelola Kategori"})}),e.jsx("div",{children:e.jsx("div",{className:"mr-2",children:e.jsx(P,{onClick:s,children:e.jsx(O,{size:22})})})})]})}),e.jsx("section",{children:e.jsx("div",{className:"mt-2 px-7",children:v?e.jsx(G,{}):e.jsx(ae,{categories:y,RefetchCategories:f})})}),e.jsx(K,{opened:i,onClose:l,title:"Tambah kategori",children:e.jsx("div",{className:"px-2 -mt-2",children:e.jsxs("form",{onSubmit:w,children:[e.jsx("div",{className:"mt-2",children:e.jsx($,{label:"Kode Kategori",size:"sm",...o.getInputProps("code")},o.key("code"))}),e.jsx("div",{className:"mt-2",children:e.jsx(B,{label:"Nama Kategori",placeholder:"Masukkan nama kategori",size:"sm",...o.getInputProps("name")},o.key("name"))}),e.jsxs("div",{className:"flex justify-between gap-2 mt-4 mb-5",children:[e.jsx(d,{size:"sm",onClick:l,fullWidth:!0,color:"gray",children:"Kembali"}),e.jsx(d,{type:"submit",fullWidth:!0,children:"Simpan"})]})]})})})]})};export{ae as CategoryData,ge as CategoryPage,G as CategorySkeleton,be as getAllCategory,Y as postCategory,J as useCreateCategory,Z as useDeleteCategory,V as useGetAllCategory,se as useUpdateCategory};
